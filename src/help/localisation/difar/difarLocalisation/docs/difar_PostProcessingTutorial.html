<html>
<head>
	<meta content="text/html; charset=windows-1252" http-equiv="Content-Type" />
	<meta content="Microsoft Word 15 (filtered)" name="Generator" />
	<title>JOURNAL ARTICLE</title>
	<style type="text/css"><!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:Consolas;
	panose-1:2 11 6 9 2 2 4 3 2 4;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:6.0pt;
	margin-left:0cm;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
h1
	{margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	line-height:115%;
	page-break-after:avoid;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";
	text-transform:uppercase;
	font-weight:bold;}
h2
	{margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";
	font-weight:bold;}
h3
	{margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";
	font-weight:normal;
	font-style:italic;}
h4
	{margin:0cm;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:8.0pt;
	font-family:"Calibri","sans-serif";
	color:black;
	text-transform:uppercase;
	font-weight:bold;}
h5
	{margin:0cm;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:8.0pt;
	font-family:"Calibri","sans-serif";
	color:black;
	text-transform:uppercase;
	font-weight:normal;}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:5.0pt;
	margin-left:0cm;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc2, li.MsoToc2, div.MsoToc2
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:5.0pt;
	margin-left:11.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc3, li.MsoToc3, div.MsoToc3
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:5.0pt;
	margin-left:22.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoFootnoteText, li.MsoFootnoteText, div.MsoFootnoteText
	{margin:0cm;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:8.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoCommentText, li.MsoCommentText, div.MsoCommentText
	{mso-style-link:"Comment Text Char";
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:6.0pt;
	margin-left:0cm;
	font-size:10.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:6.0pt;
	margin-left:0cm;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:6.0pt;
	margin-left:0cm;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoTitle, li.MsoTitle, div.MsoTitle
	{margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:12.0pt;
	margin-left:0cm;
	line-height:115%;
	font-size:18.0pt;
	font-family:"Calibri","sans-serif";
	font-weight:bold;}
p.MsoBodyText, li.MsoBodyText, div.MsoBodyText
	{mso-style-link:"Body Text Char";
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:6.0pt;
	margin-left:0cm;
	text-align:justify;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{font-family:"Times New Roman","serif";
	color:black;
	text-decoration:none;}
p.MsoDocumentMap, li.MsoDocumentMap, div.MsoDocumentMap
	{mso-style-link:"Document Map Char";
	margin:0cm;
	margin-bottom:.0001pt;
	font-size:8.0pt;
	font-family:"Tahoma","sans-serif";}
p.MsoPlainText, li.MsoPlainText, div.MsoPlainText
	{mso-style-link:"Plain Text Char";
	margin:0cm;
	margin-bottom:.0001pt;
	background:#EEECE1;
	font-size:10.5pt;
	font-family:Consolas;}
p
	{margin-right:0cm;
	margin-left:0cm;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.MsoCommentSubject, li.MsoCommentSubject, div.MsoCommentSubject
	{mso-style-link:"Comment Subject Char";
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:6.0pt;
	margin-left:0cm;
	font-size:10.0pt;
	font-family:"Calibri","sans-serif";
	font-weight:bold;}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-link:"Balloon Text Char";
	margin:0cm;
	margin-bottom:.0001pt;
	font-size:8.0pt;
	font-family:"Tahoma","sans-serif";}
p.MsoTocHeading, li.MsoTocHeading, div.MsoTocHeading
	{margin-top:24.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Cambria","serif";
	color:#365F91;
	font-weight:bold;}
p.EMailAddress, li.EMailAddress, div.EMailAddress
	{mso-style-name:EMailAddress;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";
	font-style:italic;}
p.News1, li.News1, div.News1
	{mso-style-name:News1;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:6.0pt;
	margin-left:0cm;
	text-align:justify;
	line-height:115%;
	font-size:14.0pt;
	font-family:"Arial","sans-serif";
	layout-grid-mode:line;}
p.AuthorName, li.AuthorName, div.AuthorName
	{mso-style-name:AuthorName;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:6.0pt;
	margin-left:0cm;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";
	font-variant:small-caps;}
p.AuthorAddress, li.AuthorAddress, div.AuthorAddress
	{mso-style-name:AuthorAddress;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";
	font-style:italic;}
p.AbstractHeading, li.AbstractHeading, div.AbstractHeading
	{mso-style-name:"Abstract Heading";
	margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:6.0pt;
	margin-left:35.45pt;
	line-height:115%;
	font-size:8.0pt;
	font-family:"Calibri","sans-serif";
	text-transform:uppercase;}
p.KEYWORDS, li.KEYWORDS, div.KEYWORDS
	{mso-style-name:KEYWORDS;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:6.0pt;
	margin-left:35.45pt;
	text-align:justify;
	line-height:115%;
	font-size:8.0pt;
	font-family:"Calibri","sans-serif";
	text-transform:uppercase;}
p.Abstracttext, li.Abstracttext, div.Abstracttext
	{mso-style-name:"Abstract text";
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:6.0pt;
	margin-left:35.45pt;
	text-align:justify;
	line-height:115%;
	font-size:8.0pt;
	font-family:"Calibri","sans-serif";}
p.Reflist, li.Reflist, div.Reflist
	{mso-style-name:Reflist;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:6.0pt;
	margin-left:5.65pt;
	text-align:justify;
	text-indent:-5.65pt;
	line-height:115%;
	font-size:8.0pt;
	font-family:"Calibri","sans-serif";}
span.BodyTextChar
	{mso-style-name:"Body Text Char";
	mso-style-link:"Body Text";}
span.PlainTextChar
	{mso-style-name:"Plain Text Char";
	mso-style-link:"Plain Text";
	font-family:Consolas;
	background:#EEECE1;}
span.CommentTextChar
	{mso-style-name:"Comment Text Char";
	mso-style-link:"Comment Text";}
span.CommentSubjectChar
	{mso-style-name:"Comment Subject Char";
	mso-style-link:"Comment Subject";
	font-weight:bold;}
span.BalloonTextChar
	{mso-style-name:"Balloon Text Char";
	mso-style-link:"Balloon Text";
	font-family:"Tahoma","sans-serif";}
span.DocumentMapChar
	{mso-style-name:"Document Map Char";
	mso-style-link:"Document Map";
	font-family:"Tahoma","sans-serif";}
.MsoChpDefault
	{font-size:10.0pt;
	font-family:"Calibri","sans-serif";}
 /* Page Definitions */
 @page WordSection1
	{size:21.0cm 842.0pt;
	margin:70.9pt 70.9pt 70.9pt 70.9pt;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
	</style>
</head>
<body lang="EN-AU" link="blue" vlink="black">
<div class="WordSection1">
<p class="MsoTitle"><span lang="EN-GB">Tutorial: Post-processing of data from DIFAR sonobuoys with the PAMGuard DIFAR module</span></p>

<p class="AuthorName"><span lang="EN-GB" style="text-transform: uppercase; font-variant: normal !important;">Brian S. Miller</span></p>

<p class="AuthorAddress"><span lang="EN-GB">Australian Marine Mammal Centre, Australian Antarctic Division</span></p>

<p class="EMailAddress"><span lang="EN-GB"><a href="mailto:brian.miller@aad.gov.au">brian.miller@aad.gov.au</a></span></p>

<p class="AbstractHeading"><span lang="EN-GB">Purpose of this tutorial</span></p>

<p class="Abstracttext"><span lang="EN-GB">The purpose of this tutorial is to provide step-by-step instructions for configuring and running the PAMGuard DIFAR module in order to post-process data that have been collected from DIFAR sonobuoys. This document is not intended as a guide for real-time analysis of DIFAR data, however there is considerable overlap between these two use cases. The tutorial includes step-by-step instructions for importing voyage tracks (i.e. GPS data) into PAMGuard, importing sonobuoy deployment locations into PAMGuard, configuring PAMGuard for DIFAR Localisation, and configuration of PAMGuard&rsquo;s automated Whistle and Moan Detector for use with the DIFAR Localisation module. Post-processing of DIFAR data should yield a list of magnetic and possibly true bearings to sound sources in the DIFAR data. The list of bearings can be stored in PAMGuard binary storage files and/or the PAMGuard database.</span></p>

<p class="KEYWORDS"><span lang="EN-GB">Version 1.0 2014-08-20</span></p>

<p class="MsoBodyText"><b><span lang="EN-GB">Contents</span></b></p>

<p class="MsoToc1"><span lang="EN-GB"><a href="#_Toc396467139">Preparation and expectations<span style="color: windowtext; text-decoration: none; display: none;">. </span><span style="color: windowtext; text-decoration: none; display: none;">2</span></a></span></p>

<p class="MsoToc1"><span lang="EN-GB"><a href="#_Toc396467140">Disclaimer<span style="color: windowtext; text-decoration: none; display: none;">. </span><span style="color: windowtext; text-decoration: none; display: none;">2</span></a></span></p>

<p class="MsoToc1"><span lang="EN-GB"><a href="#_Toc396467141">Installation of PAMGuard DIFAR module<span style="color: windowtext; text-decoration: none; display: none;">. </span><span style="color: windowtext; text-decoration: none; display: none;">2</span></a></span></p>

<p class="MsoToc2"><span lang="EN-GB"><a href="#_Toc396467142"><span lang="EN-AU">Custom install of the PAMGuard DIFAR jarfile</span><span style="color: windowtext; text-decoration: none; display: none;">. </span><span style="color: windowtext; text-decoration: none; display: none;">2</span></a></span></p>

<p class="MsoToc2"><span lang="EN-GB"><a href="#_Toc396467143"><span lang="EN-AU">OPTIONAL: Installation of the Greeneridge Sciences Demultiplexing Software</span><span style="color: windowtext; text-decoration: none; display: none;">. </span><span style="color: windowtext; text-decoration: none; display: none;">3</span></a></span></p>

<p class="MsoToc2"><span lang="EN-GB"><a href="#_Toc396467144"><span lang="EN-AU">A technical note on demultiplexers</span><span style="color: windowtext; text-decoration: none; display: none;">. </span><span style="color: windowtext; text-decoration: none; display: none;">3</span></a></span></p>

<p class="MsoToc2"><span lang="EN-GB"><a href="#_Toc396467145"><span lang="EN-AU">Verifying installation</span><span style="color: windowtext; text-decoration: none; display: none;">. </span><span style="color: windowtext; text-decoration: none; display: none;">4</span></a></span></p>

<p class="MsoToc1"><span lang="EN-GB"><a href="#_Toc396467146"><span lang="EN-AU">Preparation and Import of Data and Metadata</span><span style="color: windowtext; text-decoration: none; display: none;">. </span><span style="color: windowtext; text-decoration: none; display: none;">4</span></a></span></p>

<p class="MsoToc2"><span lang="EN-GB"><a href="#_Toc396467147"><span lang="EN-AU">Overview</span><span style="color: windowtext; text-decoration: none; display: none;">.. </span><span style="color: windowtext; text-decoration: none; display: none;">4</span></a></span></p>

<p class="MsoToc2"><span lang="EN-GB"><a href="#_Toc396467148">Database preparation<span style="color: windowtext; text-decoration: none; display: none;">. </span><span style="color: windowtext; text-decoration: none; display: none;">5</span></a></span></p>

<p class="MsoToc2"><span lang="EN-GB"><a href="#_Toc396467149"><span lang="EN-AU">Hydrophone array configuration</span><span style="color: windowtext; text-decoration: none; display: none;">. </span><span style="color: windowtext; text-decoration: none; display: none;">5</span></a></span></p>

<p class="MsoToc3"><span lang="EN-GB"><a href="#_Toc396467150"><span lang="EN-AU">Example: single sonobuoy deployment</span><span style="color: windowtext; text-decoration: none; display: none;">. </span><span style="color: windowtext; text-decoration: none; display: none;">6</span></a></span></p>

<p class="MsoToc3"><span lang="EN-GB"><a href="#_Toc396467151"><span lang="EN-AU">Example: Recordings with two sonobuoys</span><span style="color: windowtext; text-decoration: none; display: none;">. </span><span style="color: windowtext; text-decoration: none; display: none;">8</span></a></span></p>

<p class="MsoToc2"><span lang="EN-GB"><a href="#_Toc396467152"><span lang="EN-AU">Sonobuoy deployments &ndash; Import Streamer Data</span><span style="color: windowtext; text-decoration: none; display: none;">. </span><span style="color: windowtext; text-decoration: none; display: none;">9</span></a></span></p>

<p class="MsoToc3"><span lang="EN-GB"><a href="#_Toc396467153"><span lang="EN-AU">Validating Streamer Import</span><span style="color: windowtext; text-decoration: none; display: none;">. </span><span style="color: windowtext; text-decoration: none; display: none;">11</span></a></span></p>

<p class="MsoToc2"><span lang="EN-GB"><a href="#_Toc396467154"><span lang="EN-AU">Import ship tracks (GPS data)</span><span style="color: windowtext; text-decoration: none; display: none;">. </span><span style="color: windowtext; text-decoration: none; display: none;">13</span></a></span></p>

<p class="MsoToc3"><span lang="EN-GB"><a href="#_Toc396467155"><span lang="EN-AU">Validating GPS tracks</span><span style="color: windowtext; text-decoration: none; display: none;">. </span><span style="color: windowtext; text-decoration: none; display: none;">15</span></a></span></p>

<p class="MsoToc2"><span lang="EN-GB"><a href="#_Toc396467156"><span lang="EN-AU">Cleanup after import</span><span style="color: windowtext; text-decoration: none; display: none;">. </span><span style="color: windowtext; text-decoration: none; display: none;">15</span></a></span></p>

<p class="MsoToc2"><span lang="EN-GB"><a href="#_Toc396467157"><span lang="EN-AU">Acoustic Data Files</span><span style="color: windowtext; text-decoration: none; display: none;">. </span><span style="color: windowtext; text-decoration: none; display: none;">16</span></a></span></p>

<p class="MsoToc1"><span lang="EN-GB"><a href="#_Toc396467158"><span lang="EN-AU">Configuration of DIFAR Localisation</span><span style="color: windowtext; text-decoration: none; display: none;">. </span><span style="color: windowtext; text-decoration: none; display: none;">21</span></a></span></p>

<p class="MsoToc2"><span lang="EN-GB"><a href="#_Toc396467159"><span lang="EN-AU">Overview</span><span style="color: windowtext; text-decoration: none; display: none;">.. </span><span style="color: windowtext; text-decoration: none; display: none;">21</span></a></span></p>

<p class="MsoToc3"><span lang="EN-GB"><a href="#_Toc396467160">Required PAMGuard modules<span style="color: windowtext; text-decoration: none; display: none;">. </span><span style="color: windowtext; text-decoration: none; display: none;">21</span></a></span></p>

<p class="MsoToc3"><span lang="EN-GB"><a href="#_Toc396467161">Recommended Modules<span style="color: windowtext; text-decoration: none; display: none;">. </span><span style="color: windowtext; text-decoration: none; display: none;">21</span></a></span></p>

<p class="MsoToc2"><span lang="EN-GB"><a href="#_Toc396467162">Decimators<span style="color: windowtext; text-decoration: none; display: none;">. </span><span style="color: windowtext; text-decoration: none; display: none;">22</span></a></span></p>

<p class="MsoToc3"><span lang="EN-GB"><a href="#_Toc396467163">Omnidirectional decimator<span style="color: windowtext; text-decoration: none; display: none;">. </span><span style="color: windowtext; text-decoration: none; display: none;">22</span></a></span></p>

<p class="MsoToc3"><span lang="EN-GB"><a href="#_Toc396467164">Low frequency&nbsp; decimator (for blue/fin whale calls)<span style="color: windowtext; text-decoration: none; display: none;">. </span><span style="color: windowtext; text-decoration: none; display: none;">24</span></a></span></p>

<p class="MsoToc2"><span lang="EN-GB"><a href="#_Toc396467165"><span lang="EN-AU">FFT Engine</span><span style="color: windowtext; text-decoration: none; display: none;">. </span><span style="color: windowtext; text-decoration: none; display: none;">26</span></a></span></p>

<p class="MsoToc3"><span lang="EN-GB"><a href="#_Toc396467166"><span lang="EN-AU">Low frequency spectrogram (for blue/fin whale calls)</span><span style="color: windowtext; text-decoration: none; display: none;">. </span><span style="color: windowtext; text-decoration: none; display: none;">26</span></a></span></p>

<p class="MsoToc3"><span lang="EN-GB"><a href="#_Toc396467167"><span lang="EN-AU">Full bandwidth spectrogram (for DIFAR diagnostics)</span><span style="color: windowtext; text-decoration: none; display: none;">. </span><span style="color: windowtext; text-decoration: none; display: none;">27</span></a></span></p>

<p class="MsoToc2"><span lang="EN-GB"><a href="#_Toc396467168"><span lang="EN-AU">User Displays</span><span style="color: windowtext; text-decoration: none; display: none;">. </span><span style="color: windowtext; text-decoration: none; display: none;">29</span></a></span></p>

<p class="MsoToc1"><span lang="EN-GB"><a href="#_Toc396467169"><span lang="EN-AU">Processing DIFAR data</span><span style="color: windowtext; text-decoration: none; display: none;">. </span><span style="color: windowtext; text-decoration: none; display: none;">32</span></a></span></p>

<p class="MsoToc1"><span lang="EN-GB"><a href="#_Toc396467170"><span lang="EN-AU">Data Formats</span><span style="color: windowtext; text-decoration: none; display: none;">. </span><span style="color: windowtext; text-decoration: none; display: none;">32</span></a></span></p>

<p class="MsoNormal"><span lang="EN-GB">&nbsp;</span></p>

<h1><a name="_Toc396467139"><span lang="EN-GB">Preparation and expectations</span></a></h1>

<p class="MsoBodyText"><span lang="EN-GB">The instructions in this tutorial follow the assumption that the user already has a working installation of PAMGuard Beta version and that the user has basic familiarity with running PAMGuard. At the time of writing, the latest version of <a href="http://www.PAMGuard.org/download.php?id=37">PAMGuard Beta is 1.12.05 which can be downloaded</a> via the <a href="http://www.PAMGuard.org/">PAMGuard website</a>. Tutorials for installation and general operation of PAMGuard are available on the <a href="http://www.PAMGuard.org/">PAMGuard website</a>, and the PAMGuard online help system. The PAMGuard DIFAR module was developed and has only been tested on 64-bit Windows 7 with PAMGuard running uder a 32-bit version of the Java 7 runtime. Familiarity with acoustic detection, localisation, and DIFAR usage will be helpful, but is not required.</span></p>

<h1><a name="_Toc396467140"><span lang="EN-GB">Disclaimer</span></a></h1>

<p class="MsoBodyText"><span lang="EN-GB">Please keep in mind that the PAMGuard DIFAR module is still beta software and it may break in unexpected ways. Standard disclaimers apply: the software is available without warranty, as is where is; backup your data; don&#39;t expect too much; I&#39;m not to be held responsible if it eats your homework, frightens your pets, melts polar icecaps, etc.</span></p>

<h1><a name="_Toc396467141"><span lang="EN-GB">Installation of PAMGuard DIFAR module</span></a></h1>

<p class="MsoBodyText"><span lang="EN-GB">Installation of the PAMGuard DIFAR Module follows the general procedure for the installation of custom <i>JARFILES.</i> This installation procedure has been in practice for a number of years, and is the semi-official means for installing versions of PAMGuard with custom features outside of the mainstream releases. At the time of writing this procedure is detailed on the <a href="http://www.PAMGuard.org/46_SystemRequirements.html">System Requirements page</a> of the PAMGuard Website. A version of these instructions tailored to the DIFAR module is included below.</span></p>

<h2><a name="_Toc396467142">Custom install of the PAMGuard DIFAR jarfile</a></h2>

<p class="MsoBodyText">Download the latest PAMGuard DIFAR .jar and .ini files from the Australian Antarctic Division FTP server: <span lang="EN-GB"><a href="ftp://ftp.aad.gov.au/Public/BrianMiller/PAMGuardDifar/">ftp://ftp.aad.gov.au/Public/BrianMiller/PAMGuardDifar/</a></span></p>

<p class="MsoBodyText">In addition to the jar file you will also need other shared libraries. (E.g. the appropriate rxtx serial library will needed in order to acquire gps data). These shared libraries can be downloaded from the lib folder on the FTP server.</p>

<p class="MsoBodyText">After downloading, the .jar and .ini files and the lib folder must be copied, overwriting existing files, into an existing installation of PAMGuardBeta. If a default installation of PAMGuardBeta on windows is being used then this would mean copying the custom .jar, and .ini files and lib folder into C:\Program Files (x86)\PAMGuardBeta\.</p>

<p class="MsoBodyText">The custom version of PAMGuard with the DIFAR module can then be launched via the usual shortcuts for PAMGuard in the start menu/desktop, or alternatively with an appropriate command line, probably along the lines of:</p>

<p class="MsoPlainText">java -Djava.library.path=/your_shared_library_folder -Xms384m -Xmx1024m -jar PAMGuardDifar_YYYY-MM-DD.jar</p>

<p class="MsoBodyText">where:</p>

<p class="MsoBodyText" style="text-indent: -18pt; margin-left: 36pt;"><span style="font-family: Symbol;">&middot;<span style="font: 7pt/normal &quot;Times New Roman&quot;; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">/your_shared_library_folder </span></span>specifies the folder in which the JVM should look for shared libraries</p>

<p class="MsoBodyText" style="text-indent: -18pt; margin-left: 36pt;"><span style="font-family: Symbol;">&middot;<span style="font: 7pt/normal &quot;Times New Roman&quot;; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">-Xms</span></span><span lang="EN-GB"> </span>and <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">&ndash;Xmx</span></span> specifies the initial and maximum memory to be reserved for PAMGuard</p>

<p class="MsoBodyText" style="text-indent: -18pt; margin-left: 36pt;"><span style="font-family: Symbol;">&middot;<span style="font: 7pt/normal &quot;Times New Roman&quot;; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">PAMGuardDifar_YYYY-MM-DD.jar</span></span><span lang="EN-GB"> </span>specifies the runnable jarfile containing release e.g. 2014-08-04 of the PAMGuard DIFAR module.</p>

<p class="MsoBodyText">Once you have command line that successfully launches PAMGuard on your system then there is always the option of incorporating the command line into a suitable shell script or batch file.</p>

<h2><a name="_Toc396467143">OPTIONAL: Installation of the Greeneridge Sciences Demultiplexing Software</a></h2>

<p class="MsoBodyText">Analysis of DIFAR data requires demultiplexing (i.e. demodulation) software in order to correctly extract the signals from the directional hydrophones that are included in VHF transmissions of DIFAR sonobuoys. The PAMGuard DIFAR module was initially developed and tested with commercially available demultiplexing software licensed from <span lang="EN-GB"><a href="http://www.greeneridge.com/software.html"><span lang="EN-AU">Greeneridge Sciences Inc</span></a></span>. The Greeneridge Sciences demultiplexing software is not included by default in the PAMGuard DIFAR module. Those wishing to use the Greeneridge Sciences demultiplexer must obtain the software directly from Greeneridge Sciences Inc. Installation of the Greeneridge Sciences demultiplexer only requires placing the file GreeneridgeDemux32.dll into the lib folder as described above. Installation of the Greeneridge Demultiplexing Software is optional, but recommended.</p>

<h2><a name="_Toc396467144">A technical note on demultiplexers</a></h2>

<p class="MsoBodyText">The PAMGuard DIFAR module includes open-source demultiplexing software created at the Australian Marine Mammal Centre (AMMC). The implementation of this demultiplexing software is fundamentally different than that of Greenridge Sciences Inc. It has worked well in the limited testing that has been conducted, and it appears to give similar results to those from the Greenridge Sciencies demultiplexer.</p>

<p class="MsoBodyText">To the best of my knowledge, the Greenridge Sciences demultiplexing library used by PAMGuard is based on algorthims and computer-code that has been used successfully over the past 10 years (at the very least) to analyse DIFAR data. Thus, it is recommended over the AMMC demultiplexer, which should work, but has not yet seen extensive use.</p>

<h2><a name="_Toc396467145">Verifying installation</a></h2>

<p class="MsoBodyText">To verify that the PAMGuard DIFAR module is installed, run PAMGuard using either the shortcut from the start menu or command-line, and create a new blank settings (.psf) file. If installed correctly, the module should be available from the PAMGuard Menu under <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">File -&gt; Add Modules ... -&gt; Localisers -&gt; DIFAR Localisation</span></span>, and there should be a corresponding entry under PAMGuard&rsquo;s online help system under <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Help -&gt; Help</span></span>. Since you have now gone to the trouble of opening the DIFAR Help, it might be a good time to take a few minutes to read through the PAMGuard&rsquo;s help files in order to better familiarise yourself with general operation of the DIFAR module. NB: the online help for the DIFAR module is geared towards real-time operation, rather than the aim of this tutorial: post-processing.</p>

<p class="MsoBodyText"><img border="0" height="400" src="difar_PostProcessingTutorial_files/image001.jpg" width="604" /></p>

<h1><a name="_Toc396467146">Import of Data and Metadata</a></h1>

<h2><a name="_Toc396467147">Overview</a></h2>

<p class="MsoBodyText">The general process for post-processing DIFAR recordings is somewhat more convoluted than real-time acquisition, as data must be imported in Viewer mode, but analysed in Mixed-mode. <span lang="EN-GB">It is assumed that the user has recordings from one or more DIFAR sonobuoys, recorded at a level and sample rate suitable for recovering the directional signals (e.g. the audio was not clipped during recording and the sample rate is at least 48 kHz). The purpose of post-processing such data is to obtain magnetic and/or true bearings to sound sources audible within these recordings.</span></p>

<p class="MsoBodyText">The general procedure for post-processing data is to first configure the hydrophone array, then import the sonobuoy deployments as streamers in VIEWER mode. Ships tracks, if available can also be imported into Viewer mode. After import of sonobuoy deployments and ships tracks the DIFAR module and required sound-processing must be configured, and this can be done either in Viewer or Mixed-mode. Finally, acoustic data can be post-processed to obtain DIFAR bearings by running PAMGuard in Mixed-mode.</p>

<div style="padding: 1pt 4pt; border: 1pt solid windowtext; border-image: none;">
<p class="MsoBodyText" style="padding: 0cm; border: currentColor; border-image: none;">At this point it is wise to make a backup copy of your data/ existing PAMGuard databases before any post-processing, since post-processing may alter tables, rows, and columns of the PAMGuard database.</p>
</div>

<h2><a name="_Toc396467148"><span lang="EN-GB">Database preparation</span></a></h2>

<p class="MsoBodyText"><span lang="EN-GB">Post-processing of DIFAR data requires a database module. All development and testing of the DIFAR module were conducted using the MS Access database module. NB: I have found that the older .mdb Access databases seem to work more reliably than the newer format .accdb database files, especially on computers where MS Access is not installed. </span></p>

<p class="MsoBodyText"><span lang="EN-GB">If a PAMGuard database has already been created for this dataset (e.g. PAMGuard was used initially when collecting the data), this database can be used in lieu of importing GPS and streamer data into a blank database. However, the more likely scenario is that there is no PAMGuard database, so one must be created. An easy way to create a new database is to simply create a copy of a blank database (e.g. the one distributed with this tutorial). </span></p>

<p class="MsoPlainText">copy blank.mdb difarTutorial.mdb</p>

<p class="MsoPlainText">&nbsp;</p>

<p class="MsoBodyText">With the blank database created, run PAMGuard in Viewer-mode, and select difarTutorial.mdb as the database.</p>

<p class="MsoBodyText"><img border="0" height="187" src="difar_PostProcessingTutorial_files/image002.jpg" width="543" /></p>

<h2><a name="_Toc396467149">Hydrophone array configuration</a></h2>

<p class="MsoBodyText">Before importing any GPS or sonobuoy deployment data, the hydrophone array must be configured using PAMGuard&rsquo;s Array Manager, either in Normal, Mixed, or Viewer-Mode.</p>

<p class="MsoBodyText"><img border="0" height="378" src="difar_PostProcessingTutorial_files/image003.jpg" width="604" /></p>

<p class="MsoBodyText">Presently, it is up to the user to correctly configure the streamers, hydrophones, and channel mappings within the Array Manager in a way that is sensible for DIFAR post-processing. Thus, some explanation of how the DIFAR module maps sonobuoy deployments to Hydrophone Elements and Hydrophone Streamers within the Array Manager is required. The total number of streamers and elements defined in the Array Manager must be equal to or greater than the total number of simultaneously recorded sonobuoys in the dataset. The DIFAR module assumes that each physical DIFAR sonobuoy that is deployed will have a single hydrophone element, and thus correspond to a single audio channel. In short, a one-to-one-to-one relationship is expected between the audio channel:hydrophone element:streamer.</p>

<h3><a name="_Toc396467150">Example: single sonobuoy deployment</a></h3>

<p class="MsoBodyText">For a single sonobuoy deployment there will be one audio channel, and thus only one streamer and element is required. Configure that hydrophone element (i.e. id# 0) as follows:</p>

<p class="MsoPlainText">Streamer: Streamer 0</p>

<p class="MsoPlainText">Hydrophone type: DIFAR</p>

<p class="MsoPlainText">Hydrophone sensitivity: -122</p>

<p class="MsoPlainText">Interpolation: Use the location for the time preceeding each data unit</p>

<p class="MsoBodyText">The other fields are not required, however if it is useful for your own purposes you can enter the deployment depth of the sonobuoy as the depth coordinate. The screenshot below shows a correctly configured hydrophone.</p>

<p class="MsoBodyText"><img border="0" height="454" src="difar_PostProcessingTutorial_files/image004.jpg" width="340" /></p>

<div style="padding: 1pt 4pt; border: 1pt solid windowtext; border-image: none;">
<p class="MsoBodyText" style="padding: 0cm; border: currentColor; border-image: none;">NB: Assuming that the gain on the Analog-to-Digital Converter has been correctly set in PAMGuard, a value of -122 dB for the hydrophone sensitivity will get the spectrogram in the right ballpark of actual received levels, at least for DIFAR 53D sonobuoys received on a WinRadio G39 receivers and that have a roughly flat frequency response of 1 V audio output at 25 kHz frequency deviation. ICOM receivers (which have been commonly used on several past surveys) will have a different frequency response. The received levels won&#39;t take into account the pre-whitening filter built in each sonobuoy (i.e highpass filter from 10-100 Hz, and from 100-1000 Hz, so received levels under 100 Hz will be displayed as lower than they really are, and received levels for signals over 100 Hz will display higher, and 100 Hz will be just about right.</p>
</div>

<p class="MsoBodyText">Next configure the streamer for this hydrophone by clicking on Streamer 0, and then clicking the edit button below. Most of the details for the streamer are not important at this point, as they will be overwritten in the next step when we Import the sonobuoy deployments. However, I have always set the following at this point:</p>

<p class="MsoPlainText">Reference Position: Fixed location (moorings and buoys)</p>

<p class="MsoPlainText">Hydrophone Locator Method to: Straight / Rigid Streamer</p>

<p class="MsoPlainText">Interpolation: Use the location for the time preceeding each data unit</p>

<p class="MsoBodyText">&nbsp;</p>

<p class="MsoBodyText"><img border="0" height="455" src="difar_PostProcessingTutorial_files/image005.jpg" width="329" /></p>

<p class="MsoBodyText">If you have multiple datasets, or are planning on re-analysing data more than once, then you might want to Export the array to save yourself from having to follow the above steps for each data set. Click the Export button and name the array <span class="PlainTextChar"><span style="line-height: 115%; font-size: 10.5pt;">SingleSonobuoyArray.paf</span></span>. Then the next time that you post-process the data, you can simply import <span class="PlainTextChar"><span style="line-height: 115%; font-size: 10.5pt;">SingleSonobuoyArray.paf</span></span> instead of manually configuring the array by following the above steps.</p>

<p class="MsoBodyText">If your data set only ever contains one-channel audio (i.e. recordings from only one sonobuoy at a time), then you can continue onto the section on Importing sonobuoy deployments as streamers. Otherwise continue with the example below.</p>

<h3><a name="_Toc396467151">Example: Recordings with two sonobuoys</a></h3>

<p class="MsoBodyText">If your data contain simultaneous recordings from two sonobuoys (i.e. two channel audio), then add another streamer and another hydrophone and repeat the configuration steps for each of these as per the single-sonobuoy example&nbsp; above. When configuring hydrophone id: 1 be sure to assign it to Streamer 1 in order to maintain a 1:1:1 mapping between channels, hydrophones, and streamers.</p>

<p class="MsoBodyText">If you have multiple datasets, or are planning on re-analysing data more than once, then you might want to Export the array to save yourself from having to follow the above steps for each data set. Click the Export button and name the array <span class="PlainTextChar"><span style="line-height: 115%; font-size: 10.5pt;">TwoSonobuoyArray.paf</span></span>. Then the next time that you post-process the data, you can simply import <span class="PlainTextChar"><span style="line-height: 115%; font-size: 10.5pt;">TwoSonobuoyArray.paf</span></span> instead of manually configuring the array by following the above steps. The screenshot below shows a properly configured two-sonobuoy array.</p>

<p class="MsoBodyText"><img border="0" height="492" src="difar_PostProcessingTutorial_files/image006.jpg" width="605" /></p>

<h2><a name="_Toc396467152">Sonobuoy deployments &ndash; Import Streamer Data</a></h2>

<p class="MsoBodyText">In order to plot the correct location of sonobuoys and DIFAR bearings on the PAMGuard map, one must first input the deployment time and location of each sonobuoy. This is achieved via <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Settings -&gt; Hydrophone Array -&gt; Import Streamer Data ...</span></span></p>

<p class="MsoBodyText"><img border="0" height="122" id="Picture 28" src="difar_PostProcessingTutorial_files/image007.jpg" width="376" /></p>

<p class="MsoBodyText">The trick to post-processing DIFAR data is to first import the sonobuoy deployments as streamers in VIEWER mode. Streamers can be imported as a CSV file. The CSV file should <b>NOT</b> have a header, as the CSV import can only cope with numbers (even for the StreamerName). The format for each row in the CSV file should be:</p>

<p class="MsoPlainText"><a name="OLE_LINK1">StreamerName, StreamerID, Origin, Locator, Time,&nbsp; XPos, YPos, ZPos, XErr, YErr, ZErr, Heading, Pitch, Roll, Latitude, Longitude </a></p>

<p class="MsoBodyText">Where:</p>

<p class="MsoBodyText" style="text-indent: -18pt; margin-left: 36pt;"><span style="font-family: Symbol;">&middot;<span style="font: 7pt/normal &quot;Times New Roman&quot;; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span>StreamerIndex must be equal to an existing streamer ID (i.e. one that has already been added to the Array Manager; e.g. 0 for a single sonobuoy array, 0, or 1 for a two-sonobuoy array. The streamer index is effectively the channel mapping, since we have made sure to maintain a 1:1:1 relationship between channels, hydrophones, and streamers when configuring the array (see section above).</p>

<p class="MsoBodyText" style="text-indent: -18pt; margin-left: 36pt;"><span style="font-family: Symbol;">&middot;<span style="font: 7pt/normal &quot;Times New Roman&quot;; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Origin can either be 0 or 1 for Ship GPS or Static origins.</p>

<p class="MsoBodyText" style="text-indent: -18pt; margin-left: 36pt;"><span style="font-family: Symbol;">&middot;<span style="font: 7pt/normal &quot;Times New Roman&quot;; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Locator can either be 0 or 1 for threading or straight/rigid locators.</p>

<p class="MsoBodyText" style="text-indent: -18pt; margin-left: 36pt;"><span style="font-family: Symbol;">&middot;<span style="font: 7pt/normal &quot;Times New Roman&quot;; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Time should be an Excel date-number. This can be achieved by typing a date and time into a cell in MS Excel and hitting <enter>, then change the format of that cell to Number.</enter></p>

<p class="MsoBodyText" style="text-indent: -18pt; margin-left: 36pt;"><span style="font-family: Symbol;">&middot;<span style="font: 7pt/normal &quot;Times New Roman&quot;; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span>X,Y,ZPos and X,Y,ZErr should be specified in metres.</p>

<p class="MsoBodyText" style="text-indent: -18pt; margin-left: 36pt;"><span style="font-family: Symbol;">&middot;<span style="font: 7pt/normal &quot;Times New Roman&quot;; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Heading, Pitch and Roll should be in degrees. If the DIFAR compass correction is known, enter it into the Heading column. Pitch and Roll should probably be left null (as in the example below).</p>

<p class="MsoBodyText" style="text-indent: -18pt; margin-left: 36pt;"><span style="font-family: Symbol;">&middot;<span style="font: 7pt/normal &quot;Times New Roman&quot;; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Latitude and Longitude should be in decimal degrees with negative Latitudes for the Southern Hemisphere.</p>

<p class="MsoBodyText">Here is an example of eleven deployments from the 2013 Antarctic Blue Whale Voyage. Note that the deployments on StreamerID 0 cannot by definition overlap in time with other deployments on StreamerID 0, so the deployment of the next streamer on a channel marks both the end of the previous deployment and the start of the new deployment. Deployments on streamerID 0 can quite happily overlap in time with deployments on StreamerID 1. &nbsp;Note that sonobuoy 59 was a failure, as it has neither a precise lat/long, nor Heading (i.e. compass correction), and another sonobuoy was deployed on StreamerID1 (i.e. channel 1) almost immediately afterwards (i.e. &lt; 1/100<sup>th</sup> of a day).</p>

<p class="MsoBodyText">The entries below can be used as a template for your own data: simply change the first colum to your sonobuoy deployment number, the second column to the correct data channel/streamerID, the 5th column to your deployment time, the 12<sup>th</sup> column to your compass correction (or 0 or null if not known), and lastly change the last two columns to your latitude,longitude. When you are finished entering your sonobuoy deployments save the file as a .csv file.</p>

<p class="MsoPlainText"><a name="OLE_LINK2">52,0,1,1,41312.65103,0,0,0,0,0,0,27.4,,,-62.53047,141.00856</a></p>

<p class="MsoPlainText">53,1,1,1,41312.75039,0,0,0,0,0,0,38.9,,,-62.54945,141.70648</p>

<p class="MsoPlainText">54,0,1,1,41312.78403,0,0,0,0,0,0,30.5,,,-62.48229,141.97649</p>

<p class="MsoPlainText">55,1,1,1,41312.83917,0,0,0,0,0,0,44.6,,,-62.31181,142.28328</p>

<p class="MsoPlainText">56,0,1,1,41313.03021,0,0,0,0,0,0,33.5,,,-62.45373,142.58243</p>

<p class="MsoPlainText">57,1,1,1,41313.06223,0,0,0,0,0,0,41.4,,,-62.5171,142.86876</p>

<p class="MsoPlainText">58,0,1,1,41313.11081,0,0,0,0,0,0,34.4,,,-62.49822,143.25349</p>

<p class="MsoPlainText">59,1,1,1,41313.14236,0,0,0,0,0,0,0,,,-62,143</p>

<p class="MsoPlainText">60,1,1,1,41313.15221,0,0,0,0,0,0,48.4,,,-62.57063,143.5453</p>

<p class="MsoPlainText">61,0,1,1,41313.21843,0,0,0,0,0,0,40.4,,,-62.45458,143.90166</p>

<p class="MsoPlainText">62,0,1,1,41313.37924,0,0,0,0,0,0,40.2,,,-62.73215,143.92734</p>

<p class="MsoBodyText">Select your .csv file containing sonobuoy deployments via the Browse button on the Streamer Import Dialog, and Then click Ok.</p>

<p class="MsoBodyText"><img border="0" height="97" src="difar_PostProcessingTutorial_files/image008.jpg" width="255" /></p>

<div style="padding: 1pt 4pt; border: 1pt solid windowtext; border-image: none;">
<p class="MsoBodyText" style="padding: 0cm; border: currentColor; border-image: none;">NB: After importing streamers, it is recommended that you avoid using the Array Manager, as this could potentially modify the imported streamers and will almost certainly introduce bugs or undesired behaviours in PAMGuard.</p>
</div>

<h3><a name="_Toc396467153">Validating Streamer Import</a></h3>

<p class="MsoBodyText">Once imported a summary of the streamer data should appear in the Data Map in Viewer mode.</p>

<p class="MsoBodyText"><img border="0" height="378" id="Picture 36" src="difar_PostProcessingTutorial_files/image009.jpg" width="604" /></p>

<p class="MsoBodyText">The time-slider on the Data Map in Viewer-mode can be used to further verify that the times of the sonobuoys are correct/sensible.</p>

<p class="MsoBodyText">Additionally, adding a Map module should show the deployment locations on the PAMGuard Map (ensure that the Array Manager, Streamer Data option is checked, both by right clicking on the map and using the list, and by going to Plot Overlay Options).</p>

<p class="MsoBodyText"><img border="0" height="380" src="difar_PostProcessingTutorial_files/image010.jpg" width="504" /></p>

<p class="MsoBodyText">The time-slider on the Map in Viewer-mode can be used to further verify not only that the times of the sonobuoys are correct/sensible, but that the locations are also sensible. You will most likely need to zoom and pan to the correct location of your deployments. Additionally, you will probably need to adjust the time window (via the button with a black downward pointing triangle) in order to scroll through multiple days of data.</p>

<p class="MsoBodyText"><img border="0" height="377" id="Picture 39" src="difar_PostProcessingTutorial_files/image011.jpg" width="604" /></p>

<p class="MsoBodyText">Additionally, for two sonobuoy arrays, the map option to color the hydrophones by channel is very useful. This can be set by right-clicking on the Map -&gt; <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Map Options...</span></span></p>

<p class="MsoBodyText"><img border="0" height="310" src="difar_PostProcessingTutorial_files/image012.jpg" width="366" /></p>

<p class="MsoBodyText"><img border="0" height="436" id="Picture 40" src="difar_PostProcessingTutorial_files/image013.jpg" width="604" /></p>

<p class="MsoBodyText">If the positions aren&rsquo;t correct, or seem suspicious, then exit, re-load from your backup database, fix the CSV file, and try again.</p>

<h2><a name="_Toc396467154">OPTIONAL: Import ship tracks (GPS data)</a></h2>

<p class="MsoBodyText">Import of GPS data is only required if the GPS data are not already in the PAMGuard database (i.e. none of the data were originally collected with PAMGuard). GPS data of the ships track are required not only for viewing the track of the ship, but also to calibrate the compass of sonobuoys within the DIFAR module using noise from the vessel.</p>

<p class="MsoBodyText">First add a GPS Processing module:</p>

<p class="MsoPlainText">&nbsp;File -&gt; Add Modules -&gt; Maps and Mapping -&gt; GPS Processing.</p>

<p class="MsoBodyText"><img border="0" height="386" id="Picture 48" src="difar_PostProcessingTutorial_files/image014.jpg" width="508" /></p>

<p class="MsoBodyText">Next choose the menu option to Import GPS Data:</p>

<p class="MsoPlainText">Settings -&gt; GPS -&gt; Import GPS Data ...</p>

<p class="MsoBodyText"><img border="0" height="176" src="difar_PostProcessingTutorial_files/image015.jpg" width="331" /></p>

<p class="MsoBodyText">Select the file that contains the GPS data. Data can be in NMEA 0183 strings within a text file (personally tested and verified) or presumably in other common formats such as GPS, KML (but I haven&rsquo;t actually tried these). Importing a days worth of GPS data from NMEA text (i.e. 86400 NMEA strings) may take some time.</p>

<p class="MsoBodyText"><img border="0" height="122" src="difar_PostProcessingTutorial_files/image016.jpg" width="366" /></p>

<p class="MsoBodyText">The dialog above is a good indication that your GPS data are being imported, and also that there&rsquo;s probably time for a cup of tea.</p>

<h3><a name="_Toc396467155">Validating GPS tracks</a></h3>

<p class="MsoBodyText">As with the sonobuoy deployments, ships tracks should be visible both on the Data Map, and the Map. Again, scrolling the time slider on the Map to see that the ships track and sonobuoy deployments line up provides a good reality check to ensure that the data are at least plausible.</p>

<p class="MsoBodyText"><img border="0" height="374" src="difar_PostProcessingTutorial_files/image017.jpg" width="604" /></p>

<h3><a name="_Toc396467156">Cleanup after import</a></h3>

<p class="MsoBodyText">The GPS Import can result in an MS Access database that has an excessive file size. This provides a good excuse to create a backup of the database now that the GPS track and Sonobuoy Deployment locations have been imported.</p>

<p class="MsoBodyText">Close PAMGuard Viewer, open the database in MS Access, and save the database as a new MS Access database: e.g. difarTutorial-Imported.mdb.</p>

<p class="MsoBodyText"><img border="0" height="564" src="difar_PostProcessingTutorial_files/image018.jpg" width="470" />&nbsp;</p>

<div style="padding: 1pt 4pt; border: 1pt solid windowtext; border-image: none;">
<p class="MsoBodyText" style="padding: 0cm; border: currentColor; border-image: none;">Also, at this point it will be useful to make a backup of this file to use as a starting point for future post-processing sessions. It may be good to keep this backup in a place where it cannot be confused with the working copy (e.g. another folder) since a database file is modified each-time it is loaded into PAMGuard.</p>
</div>

<h2><a name="_Toc396467157">Acoustic Data Files</a></h2>

<p class="MsoBodyText">With sonobuoys and ships tracks imported and verified, it is finally time to make PAMGuard aware of the acoustic data. Again run PAMGuard in Viewer mode, loading the newly saved database: difarTutorial-Imported.mdb.</p>

<p class="MsoBodyText"><img border="0" height="179" src="difar_PostProcessingTutorial_files/image019.jpg" width="536" /></p>

<p class="MsoBodyText">Add a Sound Acquisition module: <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">File -&gt; Add Modules ... -&gt; Sound Processing -&gt;Sound Acquisition</span></span></p>

<p class="MsoBodyText"><img border="0" height="579" id="Picture 5" src="difar_PostProcessingTutorial_files/image020.jpg" width="550" /></p>

<p class="MsoBodyText">Sometimes Adding Modules may cause PAMGuard to appear unresponsive, however clicking on the small arrow on the Data Map will restore PAMGuard to a responsive state:</p>

<p class="MsoBodyText"><img border="0" height="214" src="difar_PostProcessingTutorial_files/image021.jpg" width="303" /></p>

<p class="MsoBodyText">Now configure the Sound Acquisition: <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Settings -&gt; Sound Acquisition ...</span></span></p>

<p class="MsoBodyText"><img border="0" height="153" id="Picture 13" src="difar_PostProcessingTutorial_files/image022.jpg" width="199" /></p>

<p class="MsoBodyText">Sound acquisition is best handled if all of the acoustic files with DIFAR data are in a single folder, or a single set of subfolders. Files should have names that PAMGuard can interpret as a timestamp, e.g. <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">code_YYYYMMDD_hhmmss.wav</span></span></p>

<p class="MsoBodyText" style="margin: 0cm 0cm 0pt 36pt; line-height: normal; text-indent: -18pt;"><span style="font-family: Symbol;">&middot;<span style="font: 7pt/normal &quot;Times New Roman&quot;; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Where <span class="PlainTextChar"><span lang="EN-GB" style="font-size: 10.5pt;">code</span></span> is a&nbsp; text identifier for the voyage (e.g. ABWV)</p>

<p class="MsoBodyText" style="margin: 0cm 0cm 0pt 36pt; line-height: normal; text-indent: -18pt;"><span style="font-family: Symbol;">&middot;<span style="font: 7pt/normal &quot;Times New Roman&quot;; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span class="PlainTextChar"><span lang="EN-GB" style="font-size: 10.5pt;">YYYY</span></span> is the 4 digit year</p>

<p class="MsoBodyText" style="margin: 0cm 0cm 0pt 36pt; line-height: normal; text-indent: -18pt;"><span style="font-family: Symbol;">&middot;<span style="font: 7pt/normal &quot;Times New Roman&quot;; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span class="PlainTextChar"><span lang="EN-GB" style="font-size: 10.5pt;">MM</span></span> is the two digit month (with leading zero for months 1-9)</p>

<p class="MsoBodyText" style="margin: 0cm 0cm 0pt 36pt; line-height: normal; text-indent: -18pt;"><span style="font-family: Symbol;">&middot;<span style="font: 7pt/normal &quot;Times New Roman&quot;; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span class="PlainTextChar"><span lang="EN-GB" style="font-size: 10.5pt;">DD</span></span> is the two digit day of the month (with leading zero for days 1-9)</p>

<p class="MsoBodyText" style="margin: 0cm 0cm 0pt 36pt; line-height: normal; text-indent: -18pt;"><span style="font-family: Symbol;">&middot;<span style="font: 7pt/normal &quot;Times New Roman&quot;; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span class="PlainTextChar"><span lang="EN-GB" style="font-size: 10.5pt;">hh</span></span> is the two digit hour of the day (24 hour clock i.e. no AM/PM with leading zero for 00-09)</p>

<p class="MsoBodyText" style="margin: 0cm 0cm 0pt 36pt; line-height: normal; text-indent: -18pt;"><span style="font-family: Symbol;">&middot;<span style="font: 7pt/normal &quot;Times New Roman&quot;; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span class="PlainTextChar"><span lang="EN-GB" style="font-size: 10.5pt;">mm</span></span> is the two digit minute (with leading zeros)</p>

<p class="MsoBodyText" style="margin: 0cm 0cm 0pt 36pt; line-height: normal; text-indent: -18pt;"><span style="font-family: Symbol;">&middot;<span style="font: 7pt/normal &quot;Times New Roman&quot;; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span class="PlainTextChar"><span lang="EN-GB" style="font-size: 10.5pt;">ss</span></span> is the two digit seconds (with leading zeros)</p>

<p class="MsoBodyText" style="margin-bottom: 0pt;">&nbsp;</p>

<p class="MsoBodyText"><span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">DAQ Settings tab: Data Source Type: Audio file folder or multiple files</span></span></p>

<p class="MsoBodyText"><span lang="EN-GB">Click the button: Select Folder or Files, and navigate to the folder containing the DIFAR acoustic files.</span></p>

<p class="MsoBodyText"><span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Merge contiguous files</span></span><span lang="EN-GB"> should be checked, otherwise DIFAR data might be cleared from the queue and map for each new file that is processed.</span></p>

<p class="MsoBodyText"><span lang="EN-GB">The </span><span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Peak-Peak voltage range</span></span><span lang="EN-GB"> is important for scaling the spectrogram and ensuring that received levels measured by the DIFAR module are somewhat representative of the actual received levels. If known, enter the </span><span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Peak-Peak voltage range</span></span><span lang="EN-GB"> of the Analog/Digital converter that was used to digitise the files. For example: The Peak-Peak Voltage of the Fireface UFX recorder used for the 2013 Antarctic Blue Whale Voyage was 8.396 V for the &ldquo;Instrument&rdquo; input with the gain was set to 20 dB. Thus one could enter either of the following which should be equivalent:</span></p>

<p class="MsoBodyText"><span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Peak-Peak voltage range:8.396, Preamplifier gain:0</span></span><span lang="EN-GB"> (tried and tested) or </span></p>

<p class="MsoBodyText"><span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Peak-Peak voltage range:83.96, Preamplifier gain:20</span></span><span lang="EN-GB"> (untested; should be equivalent).</span></p>

<p class="MsoBodyText"><span lang="EN-GB">&nbsp;</span></p>

<p class="MsoBodyText"><img border="0" height="467" id="Picture 14" src="difar_PostProcessingTutorial_files/image023.jpg" width="368" /></p>

<p class="MsoBodyText"><span lang="EN-GB">Under the </span><span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Offline Files</span></span><span lang="EN-GB"> tab, make sure the box </span><span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Use offline files</span></span><span lang="EN-GB"> is checked and once again select</span><span lang="EN-GB"> the folder containing the DIFAR acoustic files.</span></p>

<p class="MsoBodyText"><img border="0" height="470" id="Picture 15" src="difar_PostProcessingTutorial_files/image024.jpg" width="370" /></p>

<p class="MsoBodyText"><span lang="EN-GB">As with the sonobuoy deployments and ships tracks, these data should now be added to the Data Map under the Sound Acquisition.</span></p>

<p class="MsoBodyText"><img border="0" height="379" id="Picture 16" src="difar_PostProcessingTutorial_files/image025.jpg" width="604" /></p>

<p class="MsoBodyText"><span lang="EN-GB">This concludes the preparation and import of metadata. It&rsquo;s a good idea at this point to Save Data and Save Configuration (in the File menu). You can then close PAMGuard Viewer.</span></p>

<div style="padding: 1pt 4pt; border: 1pt solid windowtext; border-image: none;">
<p class="MsoBodyText" style="padding: 0cm; border: currentColor; border-image: none;">At this point it is wise to make a backup copy of your data/ existing PAMGuard databases before any post-processing, since post-processing may alter tables, rows, and columns of the PAMGuard database.</p>
</div>

<h1>Preparation and Sound Processing</h1>

<p class="MsoBodyText">The DIFAR Localisation module depends on several core PAMGuard modules, thus it is sensible to ensure that these are correctly configured before spending any time adjusting DIFAR specific settings. For configuration of these modules, I typically run PAMGuard Mixed-Mode, though theoretically configuration can occur in Normal or Viewer modes as well.</p>

<p class="MsoBodyText">When starting Mixed-Mode, load the database file that contains the sonobuoy deployments, ship track, and DIFAR audio data (i.e. the one created above).</p>

<h2><a name="_Toc396467159">Overview</a></h2>

<h3><a name="_Toc396467160"><span lang="EN-GB">Required PAMGuard modules</span></a></h3>

<p class="MsoBodyText"><span lang="EN-GB">The following modules are required for processing of DIFAR data:</span></p>

<p class="MsoBodyText" style="margin: 0cm 0cm 0pt 36pt; line-height: normal; text-indent: -18pt;"><span lang="EN-GB" style="font-family: Symbol;">&middot;<span style="font: 7pt/normal &quot;Times New Roman&quot;; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span class="PlainTextChar"><span lang="EN-GB" style="font-size: 10.5pt;">Sound Acquisition</span></span><span lang="EN-GB">: Already added and configured during Preparation and Import of Data</span></p>

<p class="MsoBodyText" style="margin: 0cm 0cm 0pt 36pt; line-height: normal; text-indent: -18pt;"><span lang="EN-GB" style="font-family: Symbol;">&middot;<span style="font: 7pt/normal &quot;Times New Roman&quot;; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span class="PlainTextChar"><span lang="EN-GB" style="font-size: 10.5pt;">Decimator</span></span><span lang="EN-GB">: To reduce the sample rate of the data you&rsquo;ll actually be looking at to a few kHz or less, depending on your target species.</span></p>

<p class="MsoBodyText" style="margin: 0cm 0cm 0pt 36pt; line-height: normal; text-indent: -18pt;"><span lang="EN-GB" style="font-family: Symbol;">&middot;<span style="font: 7pt/normal &quot;Times New Roman&quot;; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span class="PlainTextChar"><span lang="EN-GB" style="font-size: 10.5pt;">FFT (Spectrogram) Engine</span></span><span lang="EN-GB">:&nbsp;To display a spectrogram&nbsp;of the Decimated data&nbsp;for manually marking detections, and&nbsp;also to be used as input to an automatic detector.</span></p>

<p class="MsoBodyText" style="margin: 0cm 0cm 0pt 36pt; line-height: normal; text-indent: -18pt;"><span lang="EN-GB" style="font-family: Symbol;">&middot;<span style="font: 7pt/normal &quot;Times New Roman&quot;; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span class="PlainTextChar"><span lang="EN-GB" style="font-size: 10.5pt;">User Display</span></span><span lang="EN-GB">: The DIFAR display modules and spectrograms can all be integrated into a single display module. However, if you&rsquo;ve multiple screens, you may wish to make multiple user displays and spread out a little.</span></p>

<p class="MsoBodyText" style="margin: 0cm 0cm 0pt 36pt; line-height: normal; text-indent: -18pt;"><span lang="EN-GB" style="font-family: Symbol;">&middot;<span style="font: 7pt/normal &quot;Times New Roman&quot;; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span class="PlainTextChar"><span lang="EN-GB" style="font-size: 10.5pt;">DIFAR Localisation</span></span><span lang="EN-GB">: Contains the DIFAR specific components</span></p>

<h3><a name="_Toc396467161"><span lang="EN-GB">Recommended Modules</span></a></h3>

<p class="MsoBodyText"><span lang="EN-GB">The following modules are not required, but are highly recommended to facilitate analysis of DIFAR Localisations</span></p>

<p class="MsoBodyText" style="margin: 0cm 0cm 0pt 36pt; line-height: normal; text-indent: -18pt;"><span lang="EN-GB" style="font-family: Symbol;">&middot;<span style="font: 7pt/normal &quot;Times New Roman&quot;; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-GB">Additional </span><span class="PlainTextChar"><span lang="EN-GB" style="font-size: 10.5pt;">FFT (Spectrogram) Engine</span></span><span lang="EN-GB"> processing raw data from the sound acquisition. The primary purpose of this FFT is to show the spectrum of the full signal which is a useful diagnostic to determine whether the DIFAR sonobuoy is functioning correctly. The spectrum of a&nbsp;correctly functioning DIFAR sonobuoy will show spectral&nbsp;peaks&nbsp;at the&nbsp;7.5 and 15 kHz carrier frequencies. Absence of&nbsp;these peaks is&nbsp;a good indicator that something in the recording chain is amiss.</span></p>

<p class="MsoBodyText" style="margin: 0cm 0cm 0pt 36pt; line-height: normal; text-indent: -18pt;"><span lang="EN-GB" style="font-family: Symbol;">&middot;<span style="font: 7pt/normal &quot;Times New Roman&quot;; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span class="PlainTextChar"><span lang="EN-GB" style="font-size: 10.5pt;">Database</span></span><span lang="EN-GB">: DIFAR results are written to the database, so you&rsquo;ll need one if you want to store results.</span></p>

<p class="MsoBodyText" style="margin: 0cm 0cm 0pt 36pt; line-height: normal; text-indent: -18pt;"><span lang="EN-GB" style="font-family: Symbol;">&middot;<span style="font: 7pt/normal &quot;Times New Roman&quot;; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span class="PlainTextChar"><span lang="EN-GB" style="font-size: 10.5pt;">Binary store</span></span><span lang="EN-GB">: Bearings, clips of audio that have been localised, and the processed DIFARGram are stored in the binary store, so like the Database, this module is useful for further analysis of localisations will be conducted.</span></p>

<p class="MsoBodyText" style="margin: 0cm 0cm 0pt 36pt; line-height: normal; text-indent: -18pt;"><span lang="EN-GB" style="font-family: Symbol;">&middot;<span style="font: 7pt/normal &quot;Times New Roman&quot;; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span class="PlainTextChar"><span lang="EN-GB" style="font-size: 10.5pt;">GPS Processing </span></span><span lang="EN-GB">and </span><span class="PlainTextChar"><span lang="EN-GB" style="font-size: 10.5pt;">Map</span></span><span lang="EN-GB"> modules</span><span lang="EN-GB">: Already added and configured during Preparation and Import of Data.</span></p>

<p class="MsoBodyText" style="margin: 0cm 0cm 0pt 36pt; line-height: normal; text-indent: -18pt;"><span lang="EN-GB" style="font-family: Symbol;">&middot;<span style="font: 7pt/normal &quot;Times New Roman&quot;; font-size-adjust: none; font-stretch: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span class="PlainTextChar"><span lang="EN-GB" style="font-size: 10.5pt;">Whistle and moan detector:</span></span><span lang="EN-GB"> automated detection of whale sounds.</span></p>

<p class="MsoBodyText"><span lang="EN-GB">The figure below shows a typical PAMGuard model for DIFAR processing:</span><img border="0" height="341" src="difar_PostProcessingTutorial_files/image026.jpg" width="599" /></p>

<p class="MsoBodyText"><span lang="EN-GB">If you have followed the previous section of this tutorial (Preparation and Import of Data and Metadata) then the </span><span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Sound Acquisition</span></span><span lang="EN-GB">, </span><span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Database</span></span><span lang="EN-GB">, </span><span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">GPS Processing</span></span><span lang="EN-GB">, and Map modules should already be present in your configuration, and will not need to be added, though the Map module will need almost certainly need to be reconfigured at a later time (e.g. after adding and configuring the DIFAR Localisation module).</span></p>

<h2><a name="_Toc396467162"><span lang="EN-GB">Decimators</span></a></h2>

<h3><a name="_Toc396467163"><span lang="EN-GB">Omnidirectional decimator</span></a></h3>

<p class="MsoBodyText"><span lang="EN-GB">There is typically 3 kHz of usable bandwidth on the omnidirectional hydrophone on a DIFAR sonobuoy, thus it is useful to include a </span><span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Decimator</span></span><span lang="EN-GB"> when viewing the spectrogram of the omnidirectional hydrophone. </span></p>

<p class="MsoBodyText"><span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">File -&gt; Add Modules -&gt; Sound Processing -&gt; Decimator</span></span><span lang="EN-GB"> </span></p>

<p class="MsoBodyText"><span lang="EN-GB">Since there will be multiple Decimators, it is useful for each to have a descriptive name e.g. </span><span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Downsample to 6 kHz</span></span><span lang="EN-GB">.</span></p>

<p class="MsoBodyText"><span lang="EN-GB">Now configure the newly created decimator: </span><span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Settings -&gt; Downsample to 6 kHz</span></span></p>

<p class="MsoBodyText" style="line-height: normal; margin-bottom: 0pt;"><span class="PlainTextChar"><span lang="EN-GB" style="font-size: 10.5pt;">Input Data Source: Raw input from Sound Acquisition</span></span></p>

<p class="MsoBodyText" style="line-height: normal; margin-bottom: 0pt;"><span class="PlainTextChar"><span lang="EN-GB" style="font-size: 10.5pt;">Output sample rate: 6000</span></span></p>

<p class="MsoBodyText" style="margin-bottom: 0pt;"><span style="background: rgb(238, 236, 225); line-height: 115%; font-family: Consolas; font-size: 10.5pt;"><img border="0" height="247" src="difar_PostProcessingTutorial_files/image027.jpg" width="235" /></span></p>

<p class="MsoBodyText"><span lang="EN-GB">Click on the button to modify the </span><span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Filter settings</span></span></p>

<p class="MsoBodyText"><span lang="EN-GB">The following parameters are recommended for this filter:</span></p>

<p class="MsoPlainText">Filter Type: IIR Butterworth</p>

<p class="MsoPlainText">Filter Response: Low Pass</p>

<p class="MsoPlainText">Frequencies-&gt;Low Pass: 3000</p>

<p class="MsoPlainText">Filter order: 4</p>

<p class="MsoBodyText"><img border="0" height="509" id="Picture 21" src="difar_PostProcessingTutorial_files/image028.jpg" width="604" /></p>

<p class="MsoBodyText"><span lang="EN-GB">Click Ok on all of the Decimator/filter dialog boxes in order to accept the newly configured parameters.</span></p>

<h3><a name="_Toc396467164"><span lang="EN-GB">Low frequency&nbsp; decimator (for blue/fin whale calls)</span></a></h3>

<p class="MsoBodyText"><span lang="EN-GB">In addition to creating a decimated data stream containing only the omnidirectional hydrophone, it may also be desirable to create a further decimated data stream for investigation of very low frequency calls from baleen whales (especially blue and fin).</span></p>

<p class="MsoBodyText"><span lang="EN-GB">&nbsp;</span><span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">File -&gt; Add Modules -&gt; Sound Processing -&gt; Decimator</span></span><span lang="EN-GB"> </span></p>

<p class="MsoBodyText"><span lang="EN-GB">Since this is the second Decimator, it should also have a descriptive name e.g. </span><span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Downsample to 250&nbsp;Hz</span></span><span lang="EN-GB">.</span></p>

<p class="MsoBodyText"><span lang="EN-GB">Now configure the newly created decimator: </span><span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Settings -&gt; Downsample to 250&nbsp;Hz</span></span></p>

<p class="MsoBodyText" style="line-height: normal; margin-bottom: 0pt;"><span class="PlainTextChar"><span lang="EN-GB" style="font-size: 10.5pt;">Input Data Source: Downsample to 6 kHz</span></span></p>

<p class="MsoBodyText" style="line-height: normal; margin-bottom: 0pt;"><span class="PlainTextChar"><span lang="EN-GB" style="font-size: 10.5pt;">Output sample rate: 250</span></span></p>

<p class="MsoBodyText" style="margin-bottom: 0pt;"><span style="background: rgb(238, 236, 225); line-height: 115%; font-family: Consolas; font-size: 10.5pt;"><img border="0" height="245" id="Picture 22" src="difar_PostProcessingTutorial_files/image029.jpg" width="231" /></span></p>

<p class="MsoBodyText"><span lang="EN-GB">Click on the button to modify the </span><span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Filter settings</span></span></p>

<p class="MsoBodyText"><span lang="EN-GB">The following parameters are recommended for this filter:</span></p>

<p class="MsoPlainText">Filter Type: IIR Butterworth</p>

<p class="MsoPlainText">Filter Response: Low Pass</p>

<p class="MsoPlainText">Frequencies-&gt;Low Pass: 125</p>

<p class="MsoPlainText">Filter order: 4</p>

<p class="MsoBodyText"><img border="0" height="507" id="Picture 23" src="difar_PostProcessingTutorial_files/image030.jpg" width="604" /></p>

<p class="MsoBodyText"><span lang="EN-GB">Click Ok on all of the Decimator/filter dialog boxes in order to accept the newly configured parameters.</span></p>

<p class="MsoBodyText"><span lang="EN-GB">You can check the flow of data through these Decimators by looking at the Data Model: </span><span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">File -&gt; Show data model ...</span></span></p>

<p class="MsoBodyText"><b><img border="0" height="376" id="Picture 24" src="difar_PostProcessingTutorial_files/image031.jpg" width="604" /></b></p>

<h2><a name="_Toc396467165">FFT Engine</a></h2>

<h3><a name="_Toc396467166">Low frequency spectrogram (for blue/fin whale calls)</a></h3>

<p class="MsoBodyText">Viewing and often detection of sounds of interest in PAMGuard typically requires a spectrogram. Here we will add a single spectrogram and use the acoustic data that has been downsampled to 250 Hz as the source of this spectrogram. Add the spectrogram engine:</p>

<p class="MsoNormal"><span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">File -&gt; Add Modules ... -&gt; Sound Processing -&gt; FFT (Spectrogram) Engine</span></span></p>

<p class="MsoBodyText">Like the Decimators, it is useful to give this FFT (Spectrogram) Engine a more descriptive name since there may ultimately be several of these modules. Since we will configure this FFT engine to use data from the 250 Hz decimator, it will be called <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Low Frequency FFT (Spectrogram) Engine</span></span>. Now it needs to be configured. The settings below will yield ~1 Hz frequency bins and a time step of just over 100 ms, but with a lot of overlap between time slices.</p>

<p class="MsoBodyText"><span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Settings -&gt; Low Frequency FFT (Spectrogram) Engine Settings ...</span></span></p>

<p class="MsoPlainText">Raw data source for FFT: Downsample to 250 Hz data</p>

<p class="MsoPlainText">FFT Length: 256</p>

<p class="MsoPlainText">FFT Hop: 32</p>

<p class="MsoPlainText">Window: Hann</p>

<p class="MsoBodyText"><span style="background: rgb(238, 236, 225); line-height: 115%; font-family: Consolas; font-size: 10.5pt;"><img border="0" height="425" id="Picture 25" src="difar_PostProcessingTutorial_files/image032.jpg" width="343" /></span></p>

<p class="MsoBodyText">NB: I find these settings useful for visually inspecting blue and fin whale song as well as FM non-song calls such as D calls of blue whales and other low frequency FM calls made by many other baleen whales. Using the Decimator to reduce the sample rate to 250 Hz before taking the FFT can help achieve the desired balance between time resolution and frequency resolution, and additionally it substantially reduces computational requirements (compared to those required for comparable time-frequency resolution on a signal sampled at 48 kHz). Of course feel free to use any settings that suit your application.</p>

<h3><a name="_Toc396467167">Full bandwidth spectrogram (for DIFAR diagnostics)</a></h3>

<p class="MsoBodyText">In addition to visualising the acoustic data from the omnidirectional hydrophone, viewing the full bandwidth spectrum (and spectrogram) can provide valuable diagnostic information regarding the VHF reception and correct function of the DIFAR recording chain. Add another spectrogram engine:</p>

<p class="MsoNormal"><span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">File -&gt; Add Modules ... -&gt; Sound Processing -&gt; FFT (Spectrogram) Engine</span></span></p>

<p class="MsoBodyText">Again this FFT (Spectrogram) Engine should have a descriptive name since there are now several of these FFT modules. Since we will configure this FFT engine to use data from the raw audio from the VHF receiver, it will be called <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Full Bandwidth FFT (Spectrogram) Engine</span></span>. Now it needs to be configured. The exact settings for this are not critically important, as it will only be used for gross inspection the spectrum rather than detection of marine mammal sounds.</p>

<p class="MsoBodyText"><span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Settings -&gt; Full Bandwidth FFT (Spectrogram) Engine Settings ...</span></span></p>

<p class="MsoPlainText">Raw data source for FFT: Raw input data from Sound Acquisition</p>

<p class="MsoPlainText">FFT Length: 2048</p>

<p class="MsoPlainText">FFT Hop: 1024</p>

<p class="MsoPlainText">Window: Hann</p>

<p class="MsoBodyText"><img border="0" height="424" id="Picture 26" src="difar_PostProcessingTutorial_files/image033.jpg" width="338" /></p>

<p class="MsoBodyText"><span lang="EN-GB">Additional FFT engines can be added as required; e.g. an FFT engine for the Omnidirectional decimator could be added to view mid-frequency baleen whale calls and low frequency odontocete whistles.</span></p>

<p class="MsoBodyText"><span lang="EN-GB">Again, you can check the flow of data through these Decimators by looking at the Data Model: </span><span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">File -&gt; Show data model ...</span></span></p>

<p class="MsoBodyText"><span style="background: rgb(238, 236, 225); line-height: 115%; font-family: Consolas; font-size: 10.5pt;"><img border="0" height="335" id="Picture 27" src="difar_PostProcessingTutorial_files/image034.jpg" width="605" /></span></p>

<h2><a name="_Toc396467168">User Displays</a></h2>

<p class="MsoBodyText">In addition to the <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">FFT (Spectrogram) Engine</span></span>, at least one <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">User Display</span></span> is required in order to actually visualise the output from the FFT Engine.</p>

<p class="MsoPlainText">File -&gt; Add Modules ... -&gt; Displays -&gt; User Display</p>

<p class="MsoBodyText">Since we may eventually have several displays, each should be given a descriptive name. This will be the display that contains the DIFAR interface, so it should be named <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Difar Display</span></span>.</p>

<p class="MsoBodyText">A new tab with the named <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Difar Display</span></span> should appear next to the Map. The new display is a blank canvas awaiting our configuration.</p>

<p class="MsoPlainText">Display -&gt; Difar Display -&gt; Add Spectrogram</p>

<p class="MsoBodyText"><span lang="EN-GB">The new spectrogram will need to be configured.</span></p>

<p class="MsoPlainText">Data Source</p>

<p class="MsoPlainText">Source Data: FFT-256 point, 250.0 Hz-Low frequency FFT (Spectrogram)</p>

<p class="MsoPlainText">Number of Panels: 2</p>

<p class="MsoPlainText">Panel 0 channel: 0</p>

<p class="MsoPlainText">Panel 1 channel: 1</p>

<p class="MsoBodyText"><b><img border="0" height="380" id="Picture 29" src="difar_PostProcessingTutorial_files/image035.jpg" width="604" /></b></p>

<p class="MsoPlainText">Scales</p>

<p class="MsoPlainText">Frequency Range</p>

<p class="MsoPlainText">Min: 0</p>

<p class="MsoPlainText">Max: 100</p>

<p class="MsoPlainText">Amplitude Range</p>

<p class="MsoPlainText">Min: 40</p>

<p class="MsoPlainText">Max: 80</p>

<p class="MsoPlainText">Colour model Fire (multicoloured)</p>

<p class="MsoPlainText">Time Range</p>

<p class="MsoPlainText">Window length (s): 120</p>

<p class="MsoBodyText"><img border="0" height="378" id="Picture 30" src="difar_PostProcessingTutorial_files/image036.jpg" width="604" /></p>

<p class="MsoPlainText">Plug ins</p>

<p class="MsoPlainText">Full Bandwidth FFT (Spectrogram) engine</p>

<p class="MsoBodyText"><img border="0" height="380" id="Picture 31" src="difar_PostProcessingTutorial_files/image037.jpg" width="604" /></p>

<p class="MsoBodyText">Presently the <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Mark Observers</span></span> tab is empty, but it is probably worth pointing out that we will need to revisit this tab again after we have added a <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">DIFAR Localisation</span></span> module. <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Ok</span></span>.</p>

<p class="MsoBodyText">A spectrogram display should now be visible in the <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Difar Display</span></span> tab. NB: The <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Difar Display</span></span> will appear in the <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Data Model</span></span>, but will not appear to be connected to anything &ndash; this is no cause for concern: <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">User Displays</span></span> never appear connected to anything in the <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Data Model</span></span>.</p>

<div style="padding: 1pt 4pt; border: 1pt solid windowtext; border-image: none;">
<p class="MsoBodyText" style="padding: 0cm; border: currentColor; border-image: none;">At this point it is wise to make a backup copy of your data/ existing PAMGuard databases before any post-processing, since post-processing may alter tables, rows, and columns of the PAMGuard database.</p>
</div>

<p class="MsoBodyText">Before further configuration, it may be useful to run through the data while viewing the spectrogram in order to test that the spectrogram parameters are reasonable. Additionally, the Full Bandwidth FFT plug in will give a good indication of whether the data are suitable for further DIFAR processing.</p>

<p class="MsoBodyText">Click the big red circle to run through the data in Mixed-Mode.</p>

<p class="MsoBodyText"><img border="0" height="377" id="Picture 38" src="difar_PostProcessingTutorial_files/image038.jpg" width="604" />In the screenshot above, we can see that the colour scaling in the spectrogram appears reasonable: Tonal calls of Antarctic blue whales are visible at ~26 Hz, more prominently on channel 0 than channel 1, but above the background noise on both channels.</p>

<p class="MsoBodyText">The panel on the bottom shows the instantaneous spectrum (i.e. spectrum at the latest time slice). In the screenshot above, the spectrum for channel 0 (blue) shows the characteristic shape of that of a DIFAR sonobuoy with good VHF reception (i.e. strong omnidirectional signal from 0-3 kHz, carrier tones at 7.5 and 15 kHz, and directional signals modulated onto both sides of the 15 kHz carrier). The flat spectrum shown for channel 1 (red) indicates that DIFAR processing is unlikely to be successful or reliable, despite the presence of what appears to be a 26 Hz call of an Antarctic blue whale at approximately 60 s.</p>

<p class="MsoBodyText">In this specific case, we know that the sonobuoy associated with channel 1 was simply too far away to give adequate VHF reception for further DIFAR processing, however the time of arrival difference between the calls can still provide a strong indication that the calling whale is closer to the sonobuoy on channel 0 than the one on channel 1 (assuming that the detections on each channel actually correspond to the same call). This type of process, i.e. thought experiment starting from first principles, serves as useful reality check whenever using DIFAR sonobuoys, regardless of whether they seem to be operating reliably or not.</p>

<p class="MsoBodyText">If the colour contrast or time-frequency resolution of the spectrogram is not to your liking, adjust and re-run until they are fit for purpose.</p>

<div style="padding: 1pt 4pt; border: 1pt solid windowtext; border-image: none;">
<p class="MsoBodyText" style="padding: 0cm; border: currentColor; border-image: none;">At this point it is wise to make a backup copy of your data/ existing PAMGuard databases before any post-processing, since post-processing may alter tables, rows, and columns of the PAMGuard database.</p>
</div>

<h1><span lang="EN-GB">Configuration of DIFAR Localisation </span></h1>

<p class="MsoBodyText"><span lang="EN-GB">With sonobuoy deployments, ship tracks, DIFAR data, and sound processing modules all configured correctly, it is finally time to add the DIFAR Localisation module:</span></p>

<p class="MsoPlainText">File -&gt; Add Modules ...-&gt; Localisers -&gt; DIFAR Localisation</p>

<p class="MsoBodyText">There will only be one DIFAR Localisation module, so the default name is acceptable.</p>

<p class="MsoBodyText">By default the DIFAR localisation module attempts to use the Greeneridge Sciences Demultiplexer. If this demultiplexer has not been installed, a warning message will appear. This warning can safely be dismissed.</p>

<p class="MsoBodyText">The DIFAR Localisation module has a considerable number of options. Many of the default options are perfectly acceptable, but many of the default options need to be modified for specific purposes. Here we will setup the DIFAR localisation module for processing Antarctic blue whale song and D calls.</p>

<p class="MsoPlainText">Settings -&gt; DIFAR Localisation settings</p>

<h2><span lang="EN-GB">Data and buffers</span></h2>

<p class="MsoNormal"><span lang="EN-GB">The default settings on the data panel should be acceptable if using the </span><span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">AMMC_EXPERIMENTAL</span></span><span lang="EN-GB"> Demultiplexer. </span></p>

<p class="MsoPlainText">Data Source: Raw input data from Sound Acquisition</p>

<p class="MsoPlainText">Demultiplexer: AMMC_EXPERIMENTAL</p>

<p class="MsoPlainText">Prepend to clip (s): 0</p>

<p class="MsoPlainText">Time to keep Raw Data (s): 120</p>

<p class="MsoPlainText">Queued Data Buffer (m): 60</p>

<p class="MsoPlainText">Processed Data Buffer (m): 10</p>

<p class="MsoNormal"><span lang="EN-GB">If using the Greeneridge Sciences Demultiplexer, change </span><span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Prepend to clip (s): 3</span></span><span lang="EN-GB">. The </span><span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Prepend to clip</span></span><span lang="EN-GB"> setting is only required in order to allow the Greeneridge Demultiplexer to &ldquo;Lock&rdquo; onto the carrier signals before the sound of interest, and is not required by the AMMC demultiplexer.</span></p>

<p class="MsoBodyText"><img border="0" height="416" id="Picture 45" src="difar_PostProcessingTutorial_files/image039.jpg" width="295" /><img border="0" height="415" id="Picture 46" src="difar_PostProcessingTutorial_files/image040.jpg" width="295" /></p>

<h2>Species (i.e. call classification)</h2>

<p class="MsoBodyText">We now need to add species/vocalisation-specific processing parameters under the <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Species</span></span> tab. While the tab is called <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Species</span></span>, it might actually be better named Call types, Vocalisations, or Classifications. This panel allows for the creation of different classifications for each call type, and each classification/call type can have its own parameters (e.g. sample rate, frequency band, angular resolution) for analysis of DIFAR localisations.</p>

<p class="MsoBodyText">Click on the <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Edit Species List</span></span> button, and add two call types to the <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Lookup Editor (Difar Localisation species list)</span></span>.</p>

<table border="1" cellpadding="0" cellspacing="0" class="MsoTableGrid" style="border: currentColor; border-image: none; border-collapse: collapse;">
	<tbody>
		<tr>
			<td style="padding: 0cm 5.4pt; border: 1pt solid windowtext; border-image: none; width: 116.05pt;" valign="top" width="155">
			<p class="MsoPlainText">Code</p>
			</td>
			<td style="border-width: 1pt 1pt 1pt medium; border-style: solid solid solid none; border-color: windowtext windowtext windowtext currentColor; padding: 0cm 5.4pt; border-image: none; width: 116.1pt;" valign="top" width="155">
			<p class="MsoPlainText">Text</p>
			</td>
			<td style="border-width: 1pt 1pt 1pt medium; border-style: solid solid solid none; border-color: windowtext windowtext windowtext currentColor; padding: 0cm 5.4pt; border-image: none; width: 116.1pt;" valign="top" width="155">
			<p class="MsoPlainText">Selectable</p>
			</td>
			<td style="border-width: 1pt 1pt 1pt medium; border-style: solid solid solid none; border-color: windowtext windowtext windowtext currentColor; padding: 0cm 5.4pt; border-image: none; width: 116.1pt;" valign="top" width="155">
			<p class="MsoPlainText">Symbol</p>
			</td>
		</tr>
		<tr>
			<td style="border-width: medium 1pt 1pt; border-style: none solid solid; border-color: currentColor windowtext windowtext; padding: 0cm 5.4pt; border-image: none; width: 116.05pt;" valign="top" width="155">
			<p class="MsoPlainText">Abw</p>
			</td>
			<td style="border-width: medium 1pt 1pt medium; border-style: none solid solid none; border-color: currentColor windowtext windowtext currentColor; padding: 0cm 5.4pt; width: 116.1pt;" valign="top" width="155">
			<p class="MsoPlainText">Antarctic blue whale song</p>
			</td>
			<td style="border-width: medium 1pt 1pt medium; border-style: none solid solid none; border-color: currentColor windowtext windowtext currentColor; padding: 0cm 5.4pt; width: 116.1pt;" valign="top" width="155">
			<p class="MsoPlainText">checked</p>
			</td>
			<td style="border-width: medium 1pt 1pt medium; border-style: none solid solid none; border-color: currentColor windowtext windowtext currentColor; padding: 0cm 5.4pt; width: 116.1pt;" valign="top" width="155">
			<p class="MsoPlainText">Blue circle</p>
			</td>
		</tr>
		<tr>
			<td style="border-width: medium 1pt 1pt; border-style: none solid solid; border-color: currentColor windowtext windowtext; padding: 0cm 5.4pt; border-image: none; width: 116.05pt;" valign="top" width="155">
			<p class="MsoPlainText">Bwd</p>
			</td>
			<td style="border-width: medium 1pt 1pt medium; border-style: none solid solid none; border-color: currentColor windowtext windowtext currentColor; padding: 0cm 5.4pt; width: 116.1pt;" valign="top" width="155">
			<p class="MsoPlainText">blue whale d call</p>
			</td>
			<td style="border-width: medium 1pt 1pt medium; border-style: none solid solid none; border-color: currentColor windowtext windowtext currentColor; padding: 0cm 5.4pt; width: 116.1pt;" valign="top" width="155">
			<p class="MsoPlainText">checked</p>
			</td>
			<td style="border-width: medium 1pt 1pt medium; border-style: none solid solid none; border-color: currentColor windowtext windowtext currentColor; padding: 0cm 5.4pt; width: 116.1pt;" valign="top" width="155">
			<p class="MsoPlainText">Green triangle</p>
			</td>
		</tr>
	</tbody>
</table>

<p class="MsoBodyText">&nbsp;</p>

<p class="MsoBodyText"><img border="0" height="485" id="Picture 49" src="difar_PostProcessingTutorial_files/image041.jpg" width="557" />&nbsp;</p>

<p class="MsoBodyText">The selected <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Line Colour</span></span> of each symbol will be used for bearings to the species on the PAMGuard Map and Spectrogram, so selecting different line colours for each &ldquo;Species&rdquo; is a good idea. Click Ok, on the Lookup Editor to accept these two new &ldquo;species.&rdquo;</p>

<p class="MsoBodyText">NB: There are a couple of bugs regarding the symbols in the Lookup Editor: I find that filled (i.e. solid coloured) symbols are not typically desired, however The <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Fill</span></span> checkbox does not seem to influence the whether symbols are actually filled or not.&nbsp; Instead, the <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Transparency</span></span> can be set to <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">100 </span></span>under the <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">HSV </span></span>tab of the <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Fill Colour</span></span> panel (as per the figure below). Like the Fill checkbox, the <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Line thickness</span></span> setting does not appear to influence the actual thickness of the symbol or bearing lines.</p>

<p class="MsoBodyText"><img border="0" height="482" id="Picture 47" src="difar_PostProcessingTutorial_files/image042.jpg" width="604" /></p>

<p class="MsoBodyText">Now we need to configure the DIFAR analysis parameters for each of the newly added &ldquo;species.&rdquo; From the <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Select Species</span></span> drop-down menu choose <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">abw; Antarctic blue whale song</span></span>, and enter the following parameters:</p>

<p class="MsoPlainText">Difar Calculation BARTLETT</p>

<p class="MsoPlainText">Sample Rate.: 250</p>

<p class="MsoPlainText">FFT Length (samples): 256</p>

<p class="MsoPlainText">FFT Hop (samples): 32</p>

<p class="MsoPlainText">Number of Angle Bins: 360</p>

<p class="MsoPlainText">Intensity Scale: 100</p>

<p class="MsoPlainText">Beamforming Frequency Max. (Hz): 30</p>

<p class="MsoPlainText">Beamforming Frequency Min. (Hz): 25</p>

<p class="MsoPlainText">Marked Clips: Beamforming (selected)</p>

<p class="MsoPlainText">Auto Detections: Beamforming (selected)</p>

<p class="MsoBodyText"><img border="0" height="457" id="Picture 50" src="difar_PostProcessingTutorial_files/image043.jpg" width="321" /></p>

<p class="MsoBodyText">Again, from the <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Select Species</span></span> drop-down menu choose <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">bwd; blue whale d call</span></span>, and enter the following parameters:</p>

<p class="MsoPlainText">Difar Calculation BARTLETT</p>

<p class="MsoPlainText">Sample Rate.: 250</p>

<p class="MsoPlainText">FFT Length (samples): 128</p>

<p class="MsoPlainText">FFT Hop (samples): 16</p>

<p class="MsoPlainText">Number of Angle Bins: 360</p>

<p class="MsoPlainText">Intensity Scale: 100</p>

<p class="MsoPlainText">Beamforming Frequency Max. (Hz): 125</p>

<p class="MsoPlainText">Beamforming Frequency Min. (Hz): 30</p>

<p class="MsoPlainText">Marked Clips: Marked (selected)</p>

<p class="MsoPlainText">Auto Detections: Detection (selected)</p>

<p class="MsoBodyText"><img border="0" height="464" id="Picture 51" src="difar_PostProcessingTutorial_files/image044.jpg" width="323" /></p>

<p class="MsoBodyText">Additional &ldquo;species&rdquo;/call classifications can be added as required and configured in the same way as above.</p>

<h2>OPTIONAL: Calibration</h2>

<p class="MsoBodyText">The calibration tab is only required if you wish to obtain compass correction/calibration using DIFAR bearings that originate from the ships track (i.e. the one that was imported as per above). In addition to knowing the ships location, characterisation of the ship noise (i.e. identification a frequency band where ship noise remains well above background levels) is also required. This frequency band should then be entered for the <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Beamforming Frequency Max/Min</span></span> in the <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Calibration</span></span> tab.</p>

<p class="MsoBodyText">For the tutorial dataset the following Calibration settings are appropriate:</p>

<p class="MsoPlainText">Difar Calculation BARTLETT</p>

<p class="MsoPlainText">Sample Rate.: 2000</p>

<p class="MsoPlainText">FFT Length (samples): 1024</p>

<p class="MsoPlainText">FFT Hop (samples): 256</p>

<p class="MsoPlainText">Number of Angle Bins: 360</p>

<p class="MsoPlainText">Intensity Scale: 100</p>

<p class="MsoPlainText">Beamforming Frequency Max. (Hz): 800</p>

<p class="MsoPlainText">Beamforming Frequency Min. (Hz): 600</p>

<p class="MsoPlainText">Clip Length (s): 10</p>

<p class="MsoPlainText">Interval between clips (s): 10</p>

<p class="MsoPlainText">Number of clips in sequence: 20</p>

<p class="MsoBodyText"><img border="0" height="459" id="Picture 52" src="difar_PostProcessingTutorial_files/image045.jpg" width="343" /></p>

<h2>OPTIONAL: Automation</h2>

<p class="MsoBodyText">The Automation tab contains settings that should facilitate analysis of large numbers of detections.</p>

<p class="MsoBodyText">Presently no automated detectors are configured, but this top panel will need to be revisited later after adding a Whistle and Moan Detector (as per the section below).</p>

<p class="MsoBodyText">For convenience, 3 <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Quick classification</span></span> &ldquo;selectors&rdquo; can be configured to appear next to audio clips in the DIFAR queue. Since we have only configured two &ldquo;species&rdquo;, we will leave the third <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Quick classification</span></span> empty.</p>

<p class="MsoBodyText">For new users of the DIFAR module, it is recommend not to Auto-save processed clips until you are familiar with operation of the module.</p>

<p class="MsoBodyText"><img border="0" height="459" id="Picture 1" src="difar_PostProcessingTutorial_files/image046.jpg" width="347" /></p>

<h2>Configuring DIFAR Displays and Overlays</h2>

<p class="MsoBodyText">DIFAR processing is an interactive process with the computer doing the bulk of the work, but an operator making critical decisions such as validating detections,&nbsp;classifying sounds by&nbsp;species, and selecting/rejecting sounds for further processing and localisation.</p>

<p class="MsoBodyText">The DIFAR module does not have its own tab panel. Instead the various displays you&rsquo;ll need should be configured on the <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Difar Display</span></span> panel.</p>

<h3>Spectrogram Overlays and Manual Detections</h3>

<p class="MsoBodyText">The <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Low frequency FFT (Spectrogram)</span></span> should have already been added to the <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Difar Display</span></span>, but now that we have a <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">DIFAR Localisation</span></span> module we can configure the DIFAR specific overlays and functionality. Right-click on each channel of the spectrogram and ensure that both <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Queued DIFAR Data</span></span>, and <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Processed DIFAR Data</span></span> are checked. Remember overlays for Queued and Processed DIFAR Data must be enabled separately for each channel.</p>

<p class="MsoBodyText"><img border="0" height="248" id="Picture 2" src="difar_PostProcessingTutorial_files/image047.jpg" width="604" /></p>

<p class="MsoBodyText">Additionally, if you plan to mark detections by hand on the spectrogram then it is important to enable the DIFAR Localisation module to function as a Mark Observer on the spectrogram. Right-click on either channel of the spectrogram, select <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Settings &hellip;</span></span>; select the <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Mark Observers</span></span> tab, and ensure that <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">DIFAR Localisation</span></span> is checked.</p>

<p class="MsoBodyText"><img border="0" height="381" id="Picture 3" src="difar_PostProcessingTutorial_files/image048.jpg" width="604" /></p>

<h3>Map Overlays and Data Selectors</h3>

<p class="MsoBodyText">For single-monitor setups, you may also want to add an additional map to the DIFAR display. Speaking of maps, it is important to configure the <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Map</span></span> Overlays for the <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">DIFAR Localisation</span></span>.</p>

<p class="MsoBodyText">Right-click on the<span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;"> Map</span></span><span lang="EN-GB"> and select </span><span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Plot overlay options &hellip;</span></span></p>

<p class="MsoBodyText">Ensure that <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Plot</span></span> and <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">All</span></span> are checked for both <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Array manager, Streamer Data</span></span> as well as <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">DIFAR Localisation, Processed DIFAR Data</span></span>. Note that there are additional options available for the <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">DIFAR Localisation, Processed DIFAR Data</span></span>, and these can be accessed via the configuration button (i.e. the button with the gear icon). In future releases of the DIFAR Module the gear-icon will allow filtering of DIFAR bearings by species, amplitude, and tonal frequency.</p>

<p class="MsoBodyText"><img border="0" height="216" id="Picture 10" src="difar_PostProcessingTutorial_files/image049.jpg" width="450" /></p>

<p class="MsoBodyText">NB: Map overlays must be configured for each map module, so if you added an extra Map to the Difar Display, you will need to perform these steps on both that Map, and the one that is in the separate Map tab.</p>

<p class="MsoBodyText">In addition to the Map Overlays, there are also <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">DIFAR Localisation display options&hellip;</span></span> under the Display menu. The default values for these options are perfectly acceptable, and further documentation for these options are available in PAMGuard&rsquo;s Help System.</p>

<h3>DIFAR Displays</h3>

<p class="MsoBodyText">In addition to the spectrogram and map, a DIFAR Queue and a DIFAR Processing display are required to analyse DIFAR data.</p>

<p class="MsoPlainText">Difar Display -&gt; New DIFAR Localisation Queue</p>

<p class="MsoPlainText">Difar Display -&gt; New DIFAR Localisation Displays</p>

<p class="MsoBodyText"><img alt="difarUserDisplayMenu" border="0" height="240" id="Picture 4" src="difar_PostProcessingTutorial_files/image050.jpg" width="376" /></p>

<p class="MsoBodyText">The <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">DIFAR Localisation Display</span></span> does not require any configuration, and further documentation can be found in PAMGuard&rsquo;s online help system.</p>

<p class="MsoBodyText">The <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">DIFAR Localisation Queue</span></span> will likely need to be modified from the default settings in order to tailor the presentation of audio to suit the target species. Click the small downward pointing arrow below the label <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Actions</span></span> to expand the viewing options for queued clips. Clips selected for DIFAR Processing will appear in the queue as a spectrogram, and the sample rate for these clips is determined by the sample rate for the <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Default</span></span> &ldquo;species.&rdquo;</p>

<p class="MsoBodyText">Generally, the <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Min Amplitude</span></span> should be adjusted to the same value that is used by the spectrogram: for the data from the 2013 ABW Voyage 40 dB works well. In my experience, DIFAR sonobuoys typically have a dynamic range of about 40-60 dB, so set the <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Amplitude Range</span></span> to 40 dB. The <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">FFT Length</span></span> of the Queue will need to provide adequate frequency resolution at the sample rate of the <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Default</span></span> species (which we set to 2000 Hz in the section above). The following settings are recommended for viewing clips of low-frequency sounds from blue and fin whales:</p>

<p class="MsoPlainText">Min Amplitude: 40 dB</p>

<p class="MsoPlainText">Amplitdue Range: 40 dB</p>

<p class="MsoPlainText">FFT Length: 1024 pt</p>

<p class="MsoPlainText">Scale</p>

<p class="MsoPlainText">Horizontal: 8.00 x</p>

<p class="MsoPlainText">Vertical: 0.25 x</p>

<p class="MsoPlainText">Max Niquist X:0.10</p>

<p class="MsoPlainText">Max Clips: 300</p>

<p class="MsoPlainText">Max Minutes: 120</p>

<p class="MsoPlainText">New Clips Last: (checked)</p>

<p class="MsoBodyText"><img border="0" height="107" id="Picture 11" src="difar_PostProcessingTutorial_files/image051.jpg" width="604" /></p>

<p class="MsoBodyText">After configuration, the Queue settings panel can be hidden to make more room for clips by clicking the formerly downwards, but now upwards facing arrow on the far left of the panel.</p>

<h2>Binary Storage</h2>

<p class="MsoBodyText">While the GPS, streamers, and other data are stored in the PAMGuard Database module, DIFAR Localisation should probably have a Binary Storage module as well.</p>

<p class="MsoPlainText">File -&gt; Add Modules &hellip; -&gt; Utilities -&gt; Binary Storage</p>

<p class="MsoPlainText">File -&gt; Storage options &hellip;</p>

<p class="MsoBodyText">Make sure that both <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Binary Store</span></span> and <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Database</span></span> are checked for <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Processed DIFAR Data</span></span>.</p>

<p class="MsoBodyText"><img border="0" height="257" id="Picture 12" src="difar_PostProcessingTutorial_files/image052.jpg" width="276" /></p>

<p class="MsoBodyText">Additional configuration of the Binary Store is required:</p>

<p class="MsoPlainText">File -&gt; Binary Storage &hellip;</p>

<p class="MsoBodyText">Select a location (i.e. folder) for the binary storage files using the <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Browse</span></span> button, and if you are processing several days of data, it might be useful to <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Store data in sub folders by date</span></span>.</p>

<p class="MsoBodyText"><img border="0" height="213" id="Picture 19" src="difar_PostProcessingTutorial_files/image053.jpg" width="429" /></p>

<div style="padding: 1pt 4pt; border: 1pt solid windowtext; border-image: none;">
<p class="MsoBodyText" style="padding: 0cm; border: currentColor; border-image: none;">Remember that it might be a good idea to clean/move the Binary Store folder before each analysis session if you plan to re-analyse the same data multiple times.</p>
</div>

<p class="MsoNormal"><a name="_Toc396467169"><span lang="EN-GB">&nbsp;</span></a></p>

<div style="padding: 1pt 4pt; border: 1pt solid windowtext; border-image: none;">
<p class="MsoBodyText" style="padding: 0cm; border: currentColor; border-image: none;">Once you&#39;re happy with the configuration, I recommend saving yet another backup copy of the database since post-processing may alter tables, rows, and columns of the PAMGuard database, and potentially destroy all of the configuration and data.</p>
</div>

<h1>Testing DIFAR Localisation</h1>

<p class="MsoBodyText">If you have followed the tutorial up to this point, you should now have a working DIFAR localisation system, and it is almost time to hit the big red button to run the recording in Mixed mode.</p>

<h2>Controlling the speed of post-processing</h2>

<p class="MsoBodyText">However, unless you have <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Sound Output</span></span> module enabled, post-processing will most likely run too fast to allow for manual marking of every sound of interest that you see on the spectrogram. However, the <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Sound Output</span></span> can be used to control the overall speed of post-processing by adjusting the playback rate.</p>

<p class="MsoPlainText">Settings -&gt; Sound Output &hellip;</p>

<p class="MsoBodyText">It is recommended that you not use the Raw input data from Sound Acquisition as the Data source. Rather, use either the Downsample to 6 kHz or Downsample to 250 Hz, as these will facilitate playback at a faster rate, and also have filtered the constant loud whistling of the 7.5 and 15 kHz DIFAR pilot tones. Make sure that at least one <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Channel</span></span> is checked to enable the sound output. Also, make sure that the checkbox to <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Use default playback rate</span></span> is unchecked. Though it may not be obvious, the post-processing speed will now be limited by the ratio of the sample rate of the Data source divided by the <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Playback rate</span></span>. Thus, for the data source <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Downsample to 6 kHz</span></span> a <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Playback rate</span></span> of <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">48000 Hz</span></span> will yield a post-processing speed of approximately eight times faster than real-time (provided that your computer has sufficient CPU processing ability to maintain that speed). Additionally, the &ldquo;sped-up&rdquo; audio will be played through the output device (i.e. speakers) with pitch shifted by the same ratio. For low frequency sounds from blue and fin whales, shifting the pitch this way can facilitate aural detection of calls that would ordinarily be too low in frequency to be audible to most people.</p>

<div style="padding: 1pt 4pt; border: 1pt solid windowtext; border-image: none;">
<p class="MsoBodyText" style="padding: 0cm; border: currentColor; border-image: none;">NB: You can adjust the Playback rate during post-processing in order to speed up long periods with little whale activity, or to slow down post-processing if there are many sounds of interest displayed on the spectrogram.</p>
</div>

<h2>Post-processing initial run</h2>

<p class="MsoBodyText">Finally, click the red button to begin post-processing. Imported sonobuoys should automatically appear on the <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Map</span></span> at the correct time/position with no need for you to hit the <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Deploy</span></span> button or modify anything in the <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Array Manager</span></span> in any way. The spectrogram should show low-frequency audio, or it may require adjustment of the <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Min</span></span> and <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Max</span></span><span lang="EN-GB"> </span><span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Amplitude Range</span></span><span lang="EN-GB"> under the </span><span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Scales</span></span><span lang="EN-GB"> tab, or via the floating menu that can be expanded by the semi-transparent leftward pointing arrow in the upper right of the spectrogram display.</span></p>

<p class="MsoBodyText"><img border="0" height="269" id="Picture 20" src="difar_PostProcessingTutorial_files/image054.jpg" width="604" /></p>

<p class="MsoBodyText">After ensuring that the audio in the spectrogram appears with adequate contrast, select a sound of interest by clicking and dragging on the spectrogram. As you click and drag, a box will appear around the sound of interest, and after you release the mouse, the sound will appear in the <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">DIFAR Localisation Queue</span></span>.</p>

<p class="MsoBodyText">Right clip on the clip, then click on one of the <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">classifications</span></span> (or simply click on one of the <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Quick </span></span><span class="PlainTextChar"><span style="line-height: 115%; font-size: 10.5pt;">classifications</span></span> to the right of the clip if you have configured these) to analyse the sound of interest. The sound will be sent to the <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">DIFAR Localisation Displays</span></span>. In this display, you can check that the signal was demodulated by right-clicking on the spectrogram and inspecting the Demuxed NS and Demuxed EW signals, which should appear as amplitude shifted copies of the Demuxed Omni signal. Then save the localisation if you are happy with it; the bearing should appear on your map.</p>

<p class="MsoBodyText">As always, bearings to the ship are a great way to confirm that the DIFAR module is working as expected.</p>

<div style="padding: 1pt 4pt; border: 1pt solid windowtext; border-image: none;">
<p class="MsoBodyText" style="padding: 0cm; border: currentColor; border-image: none;">Once you&#39;re happy with the configuration, I recommend saving yet another backup copy of the database since post-processing may alter tables, rows, and columns of the PAMGuard database, and potentially destroy all of the configuration and data.</p>

<p class="MsoBodyText" style="padding: 0cm; border: currentColor; border-image: none;">Remember that it might be a good idea to clean/move the Binary Store folder before each analysis session if you plan to re-analyse the same data multiple times.</p>
</div>

<h1>Compass Calibration</h1>

<p class="MsoBodyText">At the time of writing, compass calibration in Mixed-mode requires a workaround since there are still unresolved issues between the Streamer Import and the Array Manager. This cause of this issue is somewhat understood and a solution is being investigated.</p>

<div style="padding: 1pt 4pt; border: 1pt solid windowtext; border-image: none;">
<p class="MsoBodyText" style="padding: 0cm; border: currentColor; border-image: none;">As stated before, DO NOT USE THE <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Deploy</span></span> button or open the <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Array Manager</span></span> when post-processing, or your sonobuoy deployments may be lost or disrupted.</p>
</div>

<p class="MsoBodyText">To calibrate the compass of a sonobuoy when post-processing, wait until after the sonobuoy-to-be-calibrated appears on the <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Map</span></span>, then click on the <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Start Calib..</span></span> button on the <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Actions</span></span> bar of the <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">DIFAR Queue Display</span></span>. Proceed with the calibration as you would in Normal Mode (see Difar Localisation Calibration under the PAMGuard Help System). Once the <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Difar calibration</span></span> window indicates <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">Calibration complete</span></span> click <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">OK</span></span>, and a new dialog window should ask if you wish to update the heading. WRITE DOWN the updated heading (either in a separate file or better yet in the correct column of the Streamer Import .csv file), and click Cancel. Clicking OK to accept the heading will likely cause that sonobuoy streamer to disappear. Cancel the Difar calibration window and exit PAMGuard.</p>

<p class="MsoBodyText">Open the PAMGuard database in MS Access, and then open the <span class="PlainTextChar"><span lang="EN-GB" style="line-height: 115%; font-size: 10.5pt;">HydrophoneStreamers</span></span> Table. Locate the streamer that was calibrated, and enter the updated heading (i.e. the one you wrote down) into the column for heading. Save the database and now when you re-run PAMGuard in Mixed mode, the hydrophone will be now be calibrated.</p>

<p class="MsoBodyText">As an alternative to editing the database using MS Access, you could enter the compass correction in the 12th column of the Streamer Import .csv, and then import the streamer/sonobuoy deployments with the updated heading into a new PAMGuard database.</p>

<h1>Automated Detection and DIFAR processing</h1>

<p class="MsoBodyText">Using PAMGuard&rsquo;s automated detectors via post-processing is identical to using them during Normal Mode, so consult the PAMGuard Help System -&gt; DIFAR Localisation -&gt; Configure DIFAR Processing -&gt; Automation for further information.</p>

<h1>&nbsp;</h1>
</div>
</body>
</html>
